<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STOUT Calc v2.0 (Fixed)</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* === –°–¢–ò–õ–ò === */
        :root { --primary: #2563EB; --primary-light: #EFF6FF; --bg: #F3F4F6; --surface: #FFFFFF; --text-main: #111827; --text-sec: #6B7280; --border: #E5E7EB; --radius: 12px; --warn-bg: #FEF2F2; --warn-text: #991B1B; --warn-border: #FCA5A5; }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text-main); margin: 0; padding: 20px; font-size: 13px; line-height: 1.4; }
        .container { display: flex; gap: 20px; width: 100%; margin: 0; align-items: flex-start; }
        .input-panel { flex: 0 0 340px; background: var(--surface); padding: 20px; border-radius: var(--radius); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); position: sticky; top: 20px; max-height: 95vh; overflow-y: auto; }
        .output-panel { flex: 1; min-width: 0; width: 100%; background: var(--surface); padding: 30px; border-radius: 4px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); display: flex; flex-direction: column; height: auto; }
        h2 { font-size: 20px; font-weight: 800; margin-bottom: 15px; letter-spacing: -0.02em; margin-top: 0; }
        h3 { font-size: 11px; font-weight: 700; color: var(--text-sec); text-transform: uppercase; margin: 20px 0 10px 0; border-top: 1px solid var(--border); padding-top: 15px; letter-spacing: 0.05em; }
        .control-item { margin-bottom: 15px; }
        .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .lbl { font-weight: 600; font-size: 13px; color: var(--text-main); }
        .lbl-sub { font-size: 11px; color: var(--text-sec); margin-bottom: 5px; font-weight: 500; display: block; }
        .val { font-weight: 700; color: var(--primary); }
        input[type=range] { width: 100%; cursor: pointer; accent-color: var(--primary); height: 6px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .control-card { background: #F9FAFB; border: 1px solid var(--border); border-radius: 10px; padding: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px; transition: 0.2s; }
        .stepper { display: flex; align-items: center; background: #fff; border: 1px solid #D1D5DB; border-radius: 6px; overflow: hidden; box-shadow: 0 1px 2px rgba(0,0,0,0.05); width: 90px; height: 28px; }
        .step-btn { width: 28px; height: 100%; border: none; background: #fff; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--text-sec); transition: 0.2s; }
        .step-btn:hover { background: #F3F4F6; color: var(--primary); }
        .step-val { width: 34px; text-align: center; font-weight: 700; font-size: 13px; }
        .switch { position: relative; display: inline-block; width: 44px; height: 24px; flex-shrink: 0; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #E5E7EB; transition: .3s; border-radius: 34px; border: 1px solid transparent; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .3s; border-radius: 50%; box-shadow: 0 1px 3px rgba(0,0,0,0.15); }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(20px); }
        .tabs { display: flex; background: #F9FAFB; padding: 3px; border-radius: 8px; border: 1px solid var(--border); }
        .tab { flex: 1; text-align: center; padding: 6px 4px; font-size: 12px; font-weight: 500; color: var(--text-sec); cursor: pointer; border-radius: 6px; transition: all 0.2s ease; }
        .tab:hover { color: var(--text-main); }
        .tab.active { background: #fff; color: var(--primary); font-weight: 700; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .tab.multi-active { background: var(--primary); color: #fff; font-weight: 700; box-shadow: 0 2px 4px rgba(37, 99, 235, 0.2); }
        .info-card { background: var(--primary-light); border-radius: 6px; padding: 8px 12px; margin-top: 8px; font-size: 11px; color: var(--primary); font-weight: 600; display: flex; align-items: center; gap: 8px; border: 1px solid #DBEAFE; }
        .doc-header { margin-bottom: 20px; border-bottom: 2px solid #000; padding-bottom: 15px; }
        .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .doc-title { font-size: 26px; font-weight: 800; text-transform: uppercase; line-height: 1; }
        .doc-summary { font-size: 11px; color: var(--text-main); font-weight: 500; background: #F9FAFB; padding: 10px 14px; border-radius: 6px; border: 1px solid var(--border); display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
        .doc-summary b { color: var(--primary); font-weight: 700; }
        .sep { color: #D1D5DB; }
        .sku-control { display: flex; align-items: center; gap: 8px; }
        .sku-label { font-size: 10px; font-weight: 700; color: var(--text-sec); text-transform: uppercase; }
        .inv-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 5px; }
        .inv-table th { text-align: left; padding: 8px 6px; font-size: 10px; font-weight: 700; text-transform: uppercase; color: var(--text-sec); border-bottom: 1px solid #000; }
        .inv-table th:last-child { text-align: right; padding-right: 0; }
        .inv-table td { padding: 5px 6px; border-bottom: 1px solid #F3F4F6; vertical-align: middle; }
        .col-img { width: 50px; text-align: center; vertical-align: middle; position: relative; }
        .img-wrap { position: relative; display: inline-flex; align-items: center; justify-content: center; }
        .prod-thumb { width: 38px; height: 38px; object-fit: contain; border-radius: 4px; background: #fff; padding: 2px; border: 1px solid #eee; transition: all 0.2s; }
        .swap-cycle-btn { display: none; position: absolute; left: -26px; top: 50%; transform: translateY(-50%); background: #2563EB; color: #fff; width: 22px; height: 22px; border-radius: 50%; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(37, 99, 235, 0.3); border: 2px solid #fff; cursor: pointer; z-index: 10; transition: all 0.2s; }
        .swap-cycle-btn:hover { background: #1d4ed8; transform: translateY(-50%) scale(1.15); }
        .show-swap-ui .swap-cycle-btn { display: flex; animation: popIn 0.2s forwards; }
        .swappable-cursor { cursor: pointer; }
        .swappable-cursor:hover .prod-thumb { border-color: var(--primary); }
        .show-swap-ui .prod-thumb { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.15); }
        @keyframes popIn { from { opacity: 0; transform: translateY(-50%) scale(0.5); } to { opacity: 1; transform: translateY(-50%) scale(1); } }
        .col-idx { width: 25px; color: #9CA3AF; text-align: center; font-size: 10px; }
        .col-name { font-weight: 600; color: var(--text-main); font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 450px; }
        .show-sku-mode .col-name { white-space: normal; overflow: visible; min-width: 200px; }
        .col-sku { width: 100px; white-space: nowrap; font-family: monospace; color: var(--text-sec); font-size: 11px; }
        .col-brand { width: 70px; text-align: center; font-size: 11px; }
        .col-unit { width: 40px; text-align: center; font-size: 11px; }
        .col-qty { width: 60px; text-align: center; font-weight: 700; }
        .col-price { text-align: right; white-space: nowrap; width: 80px; font-size: 12px; }
        .col-sum { text-align: right; font-weight: 800; padding-right: 0; white-space: nowrap; width: 90px; font-size: 12px; }
        .row-sec td { background: var(--primary-light); color: var(--primary); font-weight: 800; font-size: 11px; text-transform: uppercase; padding: 8px 6px; border-top: 2px solid #fff; }
        .row-subtotal td { text-align: right; font-style: italic; color: var(--text-sec); padding-bottom: 10px; font-size: 11px; }
        .group-header td { background-color: #EFF6FF; color: #1e3a8a; font-weight: 800; font-size: 10px; text-transform: uppercase; padding-top: 8px; padding-bottom: 6px; border: none; cursor: pointer; vertical-align: middle; }
        .group-header td:last-child { text-align: right; }
        .group-header .col-sum { text-align: right; }
        .doc-footer { margin-top: auto; padding-top: 20px; border-top: 2px solid #000; display: flex; justify-content: flex-end; align-items: baseline; gap: 15px; }
        .total-val { font-size: 24px; font-weight: 800; color: #111; }
        .footer-btns { display: flex; gap: 15px; margin-top: 25px; padding-top: 20px; border-top: 2px solid #000; }
        .btn-base { flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 10px; padding: 14px 20px; border: none; border-radius: 10px; font-weight: 700; font-size: 14px; color: #fff; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .btn-base:hover { transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.15); }
        .btn-tg { background-color: #229ED9; } .btn-tg:hover { background-color: #1c8dbf; }
        .btn-print { background-color: #111827; } .btn-print:hover { background-color: #000000; }
        @media (max-width: 600px) { .footer-btns { flex-direction: column; } .btn-base { width: 100%; } }
        .qty-wrap { display: flex; align-items: center; justify-content: center; gap: 3px; }
        .warn-box { display: block; margin-top: 5px; background: var(--warn-bg); color: var(--warn-text); border: 1px solid var(--warn-border); padding: 6px 10px; border-radius: 6px; font-size: 10px; font-weight: 700; text-transform: none; letter-spacing: normal; width: 100%; }
        .print-header { display: none; font-family: Arial, sans-serif; color: #000; margin-bottom: 20px; }
        .ph-top { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 15px; font-weight: 700; font-size: 14px; }
        .ph-main { display: flex; gap: 20px; align-items: center; font-size: 10px; line-height: 1.3; }
        .ph-logo { width: 80px; flex-shrink: 0; } .ph-logo img { width: 100%; height: auto; }
        .ph-addr { flex: 1.2; } .ph-bank { flex: 1; } .ph-line { margin-top: 10px; border: none; border-top: 3px solid #D4AF37; }
        @media print { .input-panel, .btn-print, .sku-control, .swap-cycle-btn { display: none !important; } .output-panel { box-shadow: none; width: 100%; padding: 0; border: none; } body { padding: 0; background: white; } .print-header { display: block !important; } .doc-title { font-size: 20px; margin-top: 0; } }
        
        /* === –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ó–û–ù === */
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        .title-edit { border-bottom: 1px dashed #9CA3AF; min-width: 200px; display: inline-block; color: #2563EB; outline: none; cursor: text; margin-left: 10px; }
        .title-edit:focus { border-bottom: 1px solid #2563EB; background: #EFF6FF; }
        .title-edit:empty::before { content: "–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞"; color: #9CA3AF; font-weight: 400; font-size: 26px; }
        @media print { .title-edit { border-bottom: none; color: #000; } .title-edit:empty { display: none; } }.zone-card { background: #fff; border: 1px solid #E5E7EB; border-radius: 8px; padding: 12px; margin-bottom: 10px; position: relative; box-shadow: 0 1px 2px rgba(0,0,0,0.03); }
        .zone-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid #F3F4F6; }
        .zone-title { font-weight: 700; font-size: 13px; color: #374151; min-width: 50px; outline: 1px dashed transparent; }
        .zone-title:focus { outline: 1px dashed #2563EB; background: #fff; }
        .zone-remove { color: #EF4444; font-size: 18px; cursor: pointer; line-height: 1; padding: 0 5px; opacity: 0.6; transition: 0.2s; }
        .zone-remove:hover { opacity: 1; }
        .zone-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .zone-input { width: 50px; padding: 4px; border: 1px solid #D1D5DB; border-radius: 4px; font-size: 12px; text-align: center; }
        .btn-add-zone { width: 100%; padding: 8px; background: #F3F4F6; border: 1px dashed #9CA3AF; color: #4B5563; font-weight: 600; font-size: 12px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .btn-add-zone:hover { background: #E5E7EB; color: #111; border-color: #6B7280; }

        .tooltip-wrapper { position: relative; display: inline-flex; align-items: center; margin-left: 4px; vertical-align: middle; }
        .info-icon { display: flex; align-items: center; justify-content: center; width: 14px; height: 14px; background: #DBEAFE; color: #2563EB; border-radius: 50%; font-size: 9px; font-weight: 700; cursor: help; border: 1px solid #2563EB; }
        .info-icon:hover { background: #2563EB; color: white; }
        .tooltip-content { visibility: hidden; position: absolute; z-index: 100; bottom: 135%; left: 50%; transform: translateX(-50%); width: 260px; background: #1F2937; color: #fff; padding: 10px; border-radius: 6px; font-size: 11px; line-height: 1.4; opacity: 0; transition: 0.2s; pointer-events: none; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.15); text-align: left; font-weight: 400; }
        .tooltip-wrapper:hover .tooltip-content { visibility: visible; opacity: 1; }
        .tooltip-content::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: #1F2937 transparent transparent transparent; }
    </style>
    <script>
    const REGION_DESC = { 130: "–ó–∏–º–∞ –¥–æ -35¬∞C", 120: "–ó–∏–º–∞ –¥–æ -30¬∞C", 100: "–ó–∏–º–∞ –¥–æ -25¬∞C", 60: "–ó–∏–º–∞ –¥–æ -10¬∞C" };
    const WALL_DESC = { 0.8: "–¢—ë–ø–ª—ã–π (–ì–∞–∑–æ–±–µ—Ç–æ–Ω)", 1.0: "–°—Ç–∞–Ω–¥–∞—Ä—Ç (–ö–∏—Ä–ø–∏—á)", 1.3: "–•–æ–ª–æ–¥–Ω—ã–π (–ë—Ä—É—Å)" };

    const getImg = (item) => {
        if(!item || !item.name) return '';
        let txt = item.brand==='STOUT'?'S':'B'; let bg='F3F4F6';
        if(item.type==='el') {txt='‚ö°';bg='FEF3C7';} else if(item.type==='gas') {txt='üî•';bg='FEE2E2';}
        else if(item.name.includes('–†–∞–¥–∏–∞—Ç–æ—Ä')) {txt='‚ò¢Ô∏è';bg='E0F2FE';} 
        else if(item.name.includes('–¢—Ä—É–±–∞')) {txt='‚û∞';bg='DCFCE7';}
        else if(item.name.includes('–ö–æ–ª–ª–µ–∫—Ç–æ—Ä')) {txt='üéõÔ∏è';bg='F3E8FF';} 
        else if(item.name.includes('—Å–º–µ—Å–∏—Ç–µ–ª—å–Ω—ã–π')) {txt='üîÑ';bg='F3E8FF';}
        else if(item.name.includes('–ë–æ–π–ª–µ—Ä')) {txt='üíß';bg='DBEAFE';}
        else if(item.name.includes('Warme')) {txt='üß™';bg='D1FAE5';}
        else if(item.name.includes('–ë–∞–∫')) {txt='üî¥';bg='FEE2E2';}
        else if(item.name.includes('–°—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä')) {txt='üîå';bg='FEF3C7';}
        else if(item.name.includes('–ú–∞—Ç')) {txt='üî≤';bg='F3E8FF';}
        else if(item.name.includes('Zigbee') || item.name.includes('–ì–æ–ª–æ–≤–∫–∞') || item.name.includes('–£–∑–µ–ª') || item.name.includes('–¢–µ—Ä–º–æ—Å—Ç–∞—Ç') || item.name.includes('–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä')) {txt='üîß';bg='DBEAFE';}
        else if(item.name.includes('–ò–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—è')) {txt='üöΩ';bg='F3E8FF';}
        return `<img src="img/${item.id}.jpg" class="prod-thumb" onerror="this.onerror=null;this.src='https://placehold.co/100x100/${bg}/555?text=${txt}&font=roboto';">`;
    };

    const catalog = {
        dhw_pump: [
            {id:"RCP-0005-152080", name:"–ù–∞—Å–æ—Å –ì–í–° —Å —Ç–∞–π–º–µ—Ä–æ–º (ROMMER Comfort)", price:11446, brand:"ROMMER", desc:"–ù–∞—Å–æ—Å —Ä–µ—Ü–∏—Ä–∫—É–ª—è—Ü–∏–∏ —Å —Ç–∞–π–º–µ—Ä–æ–º."},
            {id:"RCP-0005-151780", name:"–ù–∞—Å–æ—Å –ì–í–° (ROMMER Comfort)", price:10406, brand:"ROMMER", desc:"–ù–∞—Å–æ—Å —Ä–µ—Ü–∏—Ä–∫—É–ª—è—Ü–∏–∏ –±–∞–∑–æ–≤—ã–π."},
            {id:"RCP-0005-150480", name:"–ù–∞—Å–æ—Å –ì–í–° (–õ–∞—Ç—É–Ω—å)", price:5723, brand:"ROMMER", desc:"–ë—é–¥–∂–µ—Ç–Ω—ã–π –Ω–∞—Å–æ—Å, –∫–æ—Ä–ø—É—Å –ª–∞—Ç—É–Ω—å."}
        ],
        dhw_fittings: [
            {id:"SFT-0041-000001", name:"–ê–º–µ—Ä–∏–∫–∞–Ω–∫–∞ 1\" –í–†/–ù–† (–ó–º–µ–µ–≤–∏–∫ –±–æ–π–ª–µ—Ä–∞)", price:1016},
            {id:"SVB-0002-000025", name:"–ö—Ä–∞–Ω —à–∞—Ä–æ–≤–æ–π 1\" –í–†/–í–† (–ó–º–µ–µ–≤–∏–∫ –±–æ–π–ª–µ—Ä–∞)", price:1548},
            {id:"SFT-0041-000034", name:"–ê–º–µ—Ä–∏–∫–∞–Ω–∫–∞ 3/4\" –í–†/–ù–† (–ì–í–°/–†–µ—Ü–∏—Ä–∫)", price:597},
            {id:"SVB-0012-000020", name:"–ö—Ä–∞–Ω —à–∞—Ä–æ–≤–æ–π 3/4\" –í–†/–í–† (–ë–∞–±–æ—á–∫–∞)", price:865},
            {id:"RVS-0003-006015", name:"–ö–ª–∞–ø–∞–Ω –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–π 6 –±–∞—Ä", price:436, brand:"ROMMER"},
            {id:"SFT-0031-000034", name:"–ö—Ä–µ—Å—Ç–æ–≤–∏–Ω–∞ 3/4\" –í–†", price:1151},
            {id:"SVC-0012-000020", name:"–ö–ª–∞–ø–∞–Ω –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä—É–∂–∏–Ω–Ω—ã–π STOUT 3/4\"", price:1054},
            {id:"SVB-0006-000020", name:"–ö—Ä–∞–Ω —à–∞—Ä–æ–≤–æ–π 3/4\" –ù–†/–ù–† (–í—Ö–æ–¥ –•–í–°)", price:1175},
            {id:"SVC-0012-000020", name:"–û–±—Ä–∞—Ç–Ω—ã–π –∫–ª–∞–ø–∞–Ω 3/4\" (–î–ª—è —Ä–µ—Ü–∏—Ä–∫—É–ª—è—Ü–∏–∏)", price:1054} 
        ],
        boilers_gas: [
            {id:"100022963", name:"–ö–æ—Ç—ë–ª –≥–∞–∑–æ–≤—ã–π ECO Nova 1.24F (24 –∫–í—Ç)", power:24, price:61780, type:"gas", brand:"BAXI"},
            {id:"100023035", name:"–ö–æ—Ç—ë–ª –≥–∞–∑–æ–≤—ã–π ECO Nova 1.31F (31 –∫–í—Ç)", power:31, price:83990, type:"gas", brand:"BAXI"}
        ],
        boilers_plus: [
            {id:"SEB-2201-000005", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (5 –∫–í—Ç)", power:5, price:59236, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000007", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (7 –∫–í—Ç)", power:7, price:60121, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000009", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (9 –∫–í—Ç)", power:9, price:61715, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000012", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (12 –∫–í—Ç)", power:12, price:62657, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000014", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (14 –∫–í—Ç)", power:14, price:65191, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000018", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (18 –∫–í—Ç)", power:18, price:69393, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000021", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (21 –∫–í—Ç)", power:21, price:71130, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000024", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (24 –∫–í—Ç)", power:24, price:72724, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."},
            {id:"SEB-2201-000027", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π PLUS (27 –∫–í—Ç)", power:27, price:74462, type:"el", exp:12, vol:10, desc:"PLUS: –ë–∞–∫ 12–ª, –Ω–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞."}
        ],
        boilers_status: [
            {id:"SEB-3101-000005", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (5 –∫–í—Ç)", power:5, price:66207, type:"el", exp:10, vol:6, desc:"STATUS: Premium. –ë–∞–∫ 10–ª, —Å–µ–Ω—Å–æ—Ä–Ω—ã–π –¥–∏—Å–ø–ª–µ–π."},
            {id:"SEB-3101-000007", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (7 –∫–í—Ç)", power:7, price:67505, type:"el", exp:10, vol:6, desc:"STATUS: Premium. –ë–∞–∫ 10–ª, —Å–µ–Ω—Å–æ—Ä–Ω—ã–π –¥–∏—Å–ø–ª–µ–π."},
            {id:"SEB-3101-000009", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (9 –∫–í—Ç)", power:9, price:69453, type:"el", exp:10, vol:6, desc:"STATUS: Premium. –ë–∞–∫ 10–ª, —Å–µ–Ω—Å–æ—Ä–Ω—ã–π –¥–∏—Å–ø–ª–µ–π."},
            {id:"SEB-3101-000012", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (12 –∫–í—Ç)", power:12, price:70102, type:"el", exp:10, vol:6, desc:"STATUS: Premium. –ë–∞–∫ 10–ª, —Å–µ–Ω—Å–æ—Ä–Ω—ã–π –¥–∏—Å–ø–ª–µ–π."},
            {id:"SEB-3101-000014", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (14 –∫–í—Ç)", power:14, price:72698, type:"el", exp:10, vol:6, desc:"STATUS: Premium. –ë–∞–∫ 10–ª, —Å–µ–Ω—Å–æ—Ä–Ω—ã–π –¥–∏—Å–ø–ª–µ–π."},
            {id:"SEB-3101-000018", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (18 –∫–í—Ç)", power:18, price:77242, type:"el", exp:10, vol:6, desc:"STATUS: Premium. –ë–∞–∫ 10–ª, —Å–µ–Ω—Å–æ—Ä–Ω—ã–π –¥–∏—Å–ø–ª–µ–π."},
            {id:"SEB-3101-000021", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (21 –∫–í—Ç)", power:21, price:77891, type:"el", exp:10, vol:6, desc:"STATUS: Premium. –ë–∞–∫ 10–ª, —Å–µ–Ω—Å–æ—Ä–Ω—ã–π –¥–∏—Å–ø–ª–µ–π."},
            {id:"SEB-3101-000024", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (24 –∫–í—Ç)", power:24, price:78540, type:"el", exp:0, vol:11, desc:"STATUS: Premium. –í–Ω–∏–º–∞–Ω–∏–µ: –ù–ï–¢ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –±–∞–∫–∞!"},
            {id:"SEB-3101-000027", name:"–ö–æ—Ç—ë–ª —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π STATUS (27 –∫–í—Ç)", power:27, price:82435, type:"el", exp:0, vol:11, desc:"STATUS: Premium. –í–Ω–∏–º–∞–Ω–∏–µ: –ù–ï–¢ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –±–∞–∫–∞!"}
        ],
        chimneys: [{id:"SCA-6010-210850", name:"–î—ã–º–æ—Ö–æ–¥ –∫–æ–∞–∫—Å–∏–∞–ª—å–Ω—ã–π 60/100", price:6298, brand:"STOUT"}],
        stabs: [
            {id:"SST-0001-000250", name:"–°—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä ST 250", price:6905, type:"gas"}, 
            {id:"SST-0001-000600", name:"–°—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä ST 600", price:9578, type:"el"}, 
            {id:"SST-0001-000900", name:"–°—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä ST 900", price:10322, type:"el"}
        ],
        valves: [{id:"SFB-0001-000001", name:"–ö–æ–º–ø–ª–µ–∫—Ç 3-—Ö —Ö–æ–¥. –∫–ª–∞–ø–∞–Ω–∞ Fugas", price:12916, brand:"STOUT"}],
        tanks_optibase: [ 
            {id:"SWH-3110-000100", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π 100–ª", vol:100, price:57035}, 
            {id:"SWH-2110-000150", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π OptiBase 150–ª", vol:150, price:56158}, 
            {id:"SWH-2110-000200", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π OptiBase 200–ª", vol:200, price:62772}, 
            {id:"SWH-2110-000300", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π OptiBase 300–ª", vol:300, price:96910} 
        ],
        tanks_standard: [ 
            {id:"SWH-3110-000100", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π 100–ª", vol:100, price:57035}, 
            {id:"SWH-3110-000150", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π 150–ª", vol:150, price:64046}, 
            {id:"SWH-3110-000200", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π 200–ª", vol:200, price:66729}, 
            {id:"SWH-1110-000300", name:"–ë–æ–π–ª–µ—Ä –Ω–∞–ø–æ–ª—å–Ω—ã–π 300–ª", vol:300, price:114768} 
        ],
        exp_dhw: [ {id:"STW-0015-000012", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –ì–í–° 12–ª", vol:12, price:2882}, {id:"STW-0015-000018", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –ì–í–° 18–ª", vol:18, price:3316}, {id:"STW-0015-000024", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –ì–í–° 24–ª", vol:24, price:3614} ],
        exp_heating: [ {id:"STH-0004-000018", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –æ—Ç–æ–ø–ª–µ–Ω–∏—è 18–ª", vol:18, price:2897}, {id:"STH-0006-000024", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –æ—Ç–æ–ø–ª–µ–Ω–∏—è 24–ª", vol:24, price:3050}, {id:"STH-0006-000050", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –æ—Ç–æ–ø–ª–µ–Ω–∏—è 50–ª", vol:50, price:6764}, {id:"STH-0006-000080", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –æ—Ç–æ–ø–ª–µ–Ω–∏—è 80–ª", vol:80, price:10836}, {id:"STH-0006-000100", name:"–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ –¥–ª—è –æ—Ç–æ–ø–ª–µ–Ω–∏—è 100–ª", vol:100, price:12642} ],
        tank_mount: {id:"SAC-0030-000825", name:"–ö—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–ª—è –±–∞–∫–∞", price:1266},
        tank_kit: {id:"RVS-0008-002020", name:"–ö–æ–º–ø–ª–µ–∫—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–µ–º–±—Ä–∞–Ω–Ω–æ–≥–æ –±–∞–∫–∞", price:1330, brand:"ROMMER"},
        rads: [
            {id:"SRB-0320-050004", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 4 —Å–µ–∫—Ü–∏–π", sec:4, price:6457, power50: 117}, 
            {id:"SRB-0320-050005", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 5 —Å–µ–∫—Ü–∏–π", sec:5, price:7528, power50: 117}, 
            {id:"SRB-0320-050006", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 6 —Å–µ–∫—Ü–∏–π", sec:6, price:8599, power50: 117},
            {id:"SRB-0320-050007", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 7 —Å–µ–∫—Ü–∏–π", sec:7, price:9670, power50: 117}, 
            {id:"SRB-0320-050008", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 8 —Å–µ–∫—Ü–∏–π", sec:8, price:10741, power50: 117}, 
            {id:"SRB-0320-050009", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 9 —Å–µ–∫—Ü–∏–π", sec:9, price:11812, power50: 117},
            {id:"SRB-0320-050010", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 10 —Å–µ–∫—Ü–∏–π", sec:10, price:12883, power50: 117}, 
            {id:"SRB-0320-050011", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 11 —Å–µ–∫—Ü–∏–π", sec:11, price:13954, power50: 117}, 
            {id:"SRB-0320-050012", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 12 —Å–µ–∫—Ü–∏–π", sec:12, price:15025, power50: 117},
            {id:"SRB-0320-050013", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 13 —Å–µ–∫—Ü–∏–π", sec:13, price:16096, power50: 117}, 
            {id:"SRB-0320-050014", name:"–†–∞–¥–∏–∞—Ç–æ—Ä Space 14 —Å–µ–∫—Ü–∏–π", sec:14, price:17167, power50: 117}
        ],
        rad_kits: [ {id:"SFT-0049-000002", name:"–ù–∏–ø–ø–µ–ª—å", price:374} ],
        rad_tube_set: [
            {id:"SFA-0025-001650", name:"–¢—Ä—É–±–∫–∞ –ì-–æ–±—Ä–∞–∑–Ω–∞—è 16/500 –º–º (–¥–ª—è —Ä–∞–¥–∏–∞—Ç.)", price:2863, brand:"STOUT"},
            {id:"SFA-0000-162025", name:"–§–∏–∫—Å–∏—Ä—É—é—â–∞—è —Å–∫–æ–±–∞ –¥–ª—è —Ç—Ä—É–±–æ–∫", price:449, brand:"STOUT"},
            {id:"SFA-0020-000016", name:"–ì–∏–ª—å–∑–∞ –º–æ–Ω—Ç–∞–∂–Ω–∞—è 16 (–∞–∫—Å–∏–∞–ª—å–Ω–∞—è)", price:109, brand:"STOUT"},
            {id:"SFC-0027-001520", name:"–§–∏—Ç–∏–Ω–≥ –∫–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π 15x3/4\" (–¥–ª—è —Ç—Ä—É–±–∫–∏)", price:566, brand:"STOUT"}
        ],
        protective_sleeves: [
            {id:"SFA-0035-200016", name:"–ó–∞—â–∏—Ç–Ω–∞—è –≤—Ç—É–ª–∫–∞ –∫—Ä–∞—Å–Ω–∞—è (–¥–ª—è —Ç—Ä—É–±—ã 16 –º–º)", price:62, brand:"STOUT"},
            {id:"SFA-0035-100016", name:"–ó–∞—â–∏—Ç–Ω–∞—è –≤—Ç—É–ª–∫–∞ —Å–∏–Ω—è—è (–¥–ª—è —Ç—Ä—É–±—ã 16 –º–º)", price:62, brand:"STOUT"}
        ],
        label_kits: [
            {id:"SFA-0037-100000", name:"–ö–æ–º–ø–ª–µ–∫—Ç –º–∞—Ä–∫–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –Ω–∞–∫–ª–µ–µ–∫ \"–û–¢–û–ü–õ–ï–ù–ò–ï\"", price:872, brand:"STOUT"},
            {id:"SFA-0037-200000", name:"–ö–æ–º–ø–ª–µ–∫—Ç –º–∞—Ä–∫–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –Ω–∞–∫–ª–µ–µ–∫ \"–¢–ï–ü–õ–´–ô –ü–û–õ\"", price:872, brand:"STOUT"}
        ],
        heads: [
            {id:"SHT-0001-003015", name:"–ì–æ–ª–æ–≤–∫–∞ —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è (–ì–∞–∑–æ-–∂–∏–¥–∫–æ—Å—Ç–Ω–∞—è)", price:1316, type:'gas', desc:"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è."},
            {id:"SHT-0002-003015", name:"–ì–æ–ª–æ–≤–∫–∞ —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è (–ñ–∏–¥–∫–æ—Å—Ç–Ω–∞—è)", price:1334, type:'liquid', desc:"–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –Ω–∞–¥–µ–∂–Ω–∞—è –º–æ–¥–µ–ª—å."},
            {id:"STE-2070-703011", name:"–£–º–Ω–∞—è —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–æ–ª–æ–≤–∫–∞ Zigbee", price:3427, type:'smart', desc:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞. –¢—Ä–µ–±—É–µ—Ç —à–ª—é–∑."}
        ],
        smart_hub: {id:"STE-2071-804010", name:"–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–π —à–ª—é–∑ Zigbee", price:4896},
        ufh_mech: [
            {id:"STE-2001-130210", name:"–¢–µ—Ä–º–æ—Å—Ç–∞—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, –±–µ–ª—ã–π", price:2142, desc:"–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç (–ë–µ–ª—ã–π)."},
            {id:"STE-2001-130220", name:"–¢–µ—Ä–º–æ—Å—Ç–∞—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, —á–µ—Ä–Ω—ã–π", price:2249, desc:"–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç (–ß–µ—Ä–Ω—ã–π)."}
        ],
        ufh_electro: [
            {id:"STE-2002-331212", name:"–¢–µ—Ä–º–æ—Ä–µ–≥—É–ª—è—Ç–æ—Ä —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, –±–µ–ª—ã–π", price:11603, desc:"–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç —Å –¥–∏—Å–ø–ª–µ–µ–º (–ë–µ–ª—ã–π)."},
            {id:"STE-2002-331222", name:"–¢–µ—Ä–º–æ—Ä–µ–≥—É–ª—è—Ç–æ—Ä —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, —á–µ—Ä–Ω—ã–π", price:12067, desc:"–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç —Å –¥–∏—Å–ø–ª–µ–µ–º (–ß–µ—Ä–Ω—ã–π)."}
        ],
        actuators: {id:"STE-0010-230001", name:"–°–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π 230–í (NC)", price:2458},
        wiring_center: {id:"STE-3050-650522", name:"–ü—Ä–æ–≤–æ–¥–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä", price:7446},
        h_valves: [
            {id:"SVH-0004-000020", name:"–£–∑–µ–ª –Ω–∏–∂–Ω. –ø–æ–¥–∫–ª. (–£–≥–ª–æ–≤–æ–π)", price:1161, type:'angled', desc:"–¢—Ä—É–±—ã –≤—ã—Ö–æ–¥—è—Ç –∏–∑ —Å—Ç–µ–Ω—ã."},
            {id:"SVH-0002-000020", name:"–£–∑–µ–ª –Ω–∏–∂–Ω. –ø–æ–¥–∫–ª. (–ü—Ä—è–º–æ–π)", price:1141, type:'straight', desc:"–¢—Ä—É–±—ã –≤—ã—Ö–æ–¥—è—Ç –∏–∑ –ø–æ–ª–∞."}
        ],
        manifolds_rad: [
            {id:"SMS-0922-000002", loops:2, price:7643, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 2 –≤—ã—Ö."},
            {id:"SMS-0922-000003", loops:3, price:9477, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 3 –≤—ã—Ö."},
            {id:"SMS-0922-000004", loops:4, price:11320, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 4 –≤—ã—Ö."},
            {id:"SMS-0922-000005", loops:5, price:13418, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 5 –≤—ã—Ö."},
            {id:"SMS-0922-000006", loops:6, price:15374, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 6 –≤—ã—Ö."},
            {id:"SMS-0922-000007", loops:7, price:17792, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 7 –≤—ã—Ö."},
            {id:"SMS-0922-000008", loops:8, price:19985, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 8 –≤—ã—Ö."},
            {id:"SMS-0922-000009", loops:9, price:21902, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 9 –≤—ã—Ö."},
            {id:"SMS-0922-000010", loops:10, price:24063, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 10 –≤—ã—Ö."},
            {id:"SMS-0922-000011", loops:11, price:25961, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 11 –≤—ã—Ö."},
            {id:"SMS-0922-000012", loops:12, price:27830, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 12 –≤—ã—Ö."},
            {id:"SMS-0922-000013", loops:13, price:31212, name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–¥–∏–∞—Ç–æ—Ä–Ω—ã–π 13 –≤—ã—Ö."}
        ],
        manifolds_chrome_blocks: [
            {id:"SMB-6850-013402", name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä–Ω—ã–π –±–ª–æ–∫ 1\" x 2 –≤—ã—Ö", loops:2, price:2983, brand:"STOUT"},
            {id:"SMB-6850-013403", name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä–Ω—ã–π –±–ª–æ–∫ 1\" x 3 –≤—ã—Ö", loops:3, price:4169, brand:"STOUT"},
            {id:"SMB-6850-013404", name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä–Ω—ã–π –±–ª–æ–∫ 1\" x 4 –≤—ã—Ö", loops:4, price:5511, brand:"STOUT"}
        ],
        manifold_brackets: {id:"SMB-0002-000002", name:"–ö—Ä–æ–Ω—à—Ç–µ–π–Ω—ã –¥–ª—è –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–æ–≤ (–ø–∞—Ä–∞)", price:612, brand:"STOUT"},
        pipes: [ {id:"SPX-0002-101620", name:"–¢—Ä—É–±–∞ 16x2.0 (100 –º)", len:100, price:15200}, {id:"SPX-0002-501620", name:"–¢—Ä—É–±–∞ 16x2.0 (500 –º)", len:500, price:85270} ],
        insulated_pipes: [ 
            {id:"SPI-0003-001622", name:"–¢—Ä—É–±–∞ 16x2.2 –≤ —Ç–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏–∏ (–∫—Ä–∞—Å–Ω–∞—è)", len:100, price:22000}, 
            {id:"SPI-0004-001622", name:"–¢—Ä—É–±–∞ 16x2.2 –≤ —Ç–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏–∏ (—Å–∏–Ω—è—è)", len:100, price:22000} 
        ],
        rad_pipes_grey: [
            {id:"SPX-0001-001622", name:"–¢—Ä—É–±–∞ PEX-a/EVOH —Å–µ—Ä–∞—è 16x2.2 (100–º)", len:100, price:17500}, 
            {id:"SPX-0001-241622", name:"–¢—Ä—É–±–∞ PEX-a/EVOH —Å–µ—Ä–∞—è 16x2.2 (240–º)", len:240, price:42000}, 
            {id:"SPX-0001-501622", name:"–¢—Ä—É–±–∞ PEX-a/EVOH —Å–µ—Ä–∞—è 16x2.2 (500–º)", len:500, price:98735}  
        ],
        insulation: [
            {id:"EFXT018062SUPRK-400", name:"–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è 18/6 (–ö—Ä–∞—Å–Ω–∞—è)", price:28, unit:"–º", brand:"Energoflex"}, 
            {id:"EFXT018062SUPRS-400", name:"–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è 18/6 (–°–∏–Ω—è—è)", price:28, unit:"–º", brand:"Energoflex"}
        ],
        manifolds: [
            {id:"SMS-0917-000002", loops:2, price:8479}, {id:"SMS-0917-000003", loops:3, price:10717}, {id:"SMS-0917-000004", loops:4, price:12973}, {id:"SMS-0917-000005", loops:5, price:15532},
            {id:"SMS-0917-000006", loops:6, price:17796}, {id:"SMS-0917-000007", loops:7, price:20830}, {id:"SMS-0917-000008", loops:8, price:23477}, {id:"SMS-0917-000009", loops:9, price:25873},
            {id:"SMS-0917-000010", loops:10, price:28480}, {id:"SMS-0917-000011", loops:11, price:30864}, {id:"SMS-0917-000012", loops:12, price:33210}
        ],
        parts: [ 
            {id:"SMS-1000-010001", name:"–ö–æ–Ω—Ü–µ–≤–æ–π —Ñ–∏—Ç–∏–Ω–≥", price:2441}, 
            {id:"SFC-0020-001622", name:"–ï–≤—Ä–æ–∫–æ–Ω—É—Å 16x2.2 (–†–∞–¥–∏–∞—Ç–æ—Ä—ã)", price:381},
            {id:"SFA-0029-000016", name:"–§–∏–∫—Å–∞—Ç–æ—Ä 90", price:127},
            {id:"SFC-0020-001620", name:"–ï–≤—Ä–æ–∫–æ–Ω—É—Å 16x2.0 (–¢–µ–ø–ª—ã–π –ø–æ–ª)", price:376}
        ],
        mixing_units: [ {id:"SDG-0120-001000", name:"–ù–∞—Å–æ—Å–Ω–æ-—Å–º–µ—Å–∏—Ç–µ–ª—å–Ω—ã–π —É–∑–µ–ª (–±–µ–∑ –Ω–∞—Å–æ—Å–∞)", price:25684} ],
        groups_dn20: [ {id:"SDG-0001-002001", name:"–ì—Ä—É–ø–ø–∞ –Ω–∞—Å–æ—Å–Ω–∞—è DN20 (–ü—Ä—è–º–∞—è)", price:16243}, {id:"SDG-0002-002001", name:"–ì—Ä—É–ø–ø–∞ –Ω–∞—Å–æ—Å–Ω–∞—è DN20 (–°–º–µ—Å.)", price:29589} ],
        groups_dn25: [ {id:"SDG-0001-002501", name:"–ì—Ä—É–ø–ø–∞ –Ω–∞—Å–æ—Å–Ω–∞—è DN25 (–ü—Ä—è–º–∞—è)", price:17535}, {id:"SDG-0002-002501", name:"–ì—Ä—É–ø–ø–∞ –Ω–∞—Å–æ—Å–Ω–∞—è DN25 (–°–º–µ—Å.)", price:31942} ],
        hydro_dn20: [ {id:"SDG-0018-002502", name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä-–≥–∏–¥—Ä–æ—Å—Ç—Ä–µ–ª–∫–∞ DN20 (2 –∫–æ–Ω—Ç)", price:50005}, {id:"SDG-0018-002503", name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä-–≥–∏–¥—Ä–æ—Å—Ç—Ä–µ–ª–∫–∞ DN20 (3 –∫–æ–Ω—Ç)", price:57133} ],
        hydro_dn25: [ {id:"SDG-0018-004002", name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä-–≥–∏–¥—Ä–æ—Å—Ç—Ä–µ–ª–∫–∞ DN25 (2 –∫–æ–Ω—Ç)", price:56826}, {id:"SDG-0018-004003", name:"–ö–æ–ª–ª–µ–∫—Ç–æ—Ä-–≥–∏–¥—Ä–æ—Å—Ç—Ä–µ–ª–∫–∞ DN25 (3 –∫–æ–Ω—Ç)", price:64925} ],
        pumps_dn20: [ {id:"RCP-0002-1560130", brand:"ROMMER", name:"–ù–∞—Å–æ—Å 15/60-130", price:3364} ],
        pumps_dn25: [
            {id:"SPC-0011-2560180", name:"–ù–∞—Å–æ—Å —Ü–∏—Ä–∫—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π 25/60-180", price:11669, type:'default', desc:"–ë–∞–∑–æ–≤—ã–π –Ω–∞—Å–æ—Å STOUT 25/60-180."},
            {id:"SPC-0010-2560180", name:"–ù–∞—Å–æ—Å —Ü–∏—Ä–∫—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π 25/60-180 (Std)", price:11669, type:'std', desc:"–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π 3-—Ö —Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–π –Ω–∞—Å–æ—Å."},
            {id:"SPC-0002-2560180", name:"–ù–∞—Å–æ—Å —Ü–∏—Ä–∫—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π Mini 25/60-180", price:21680, type:'mini', desc:"–≠–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π (—á–∞—Å—Ç–æ—Ç–Ω—ã–π)."},
            {id:"SPC-0003-2560180", name:"–ù–∞—Å–æ—Å —Ü–∏—Ä–∫—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π Mini Pro 25/60-180", price:30622, type:'pro', desc:"–ü—Ä–µ–º–∏—É–º Smart (–¥–∏—Å–ø–ª–µ–π, –∞–≤—Ç–æ-–∞–¥–∞–ø—Ç–∞—Ü–∏—è)."}
        ],
        pumps_mix: [ {id:"SPC-0011-2560130", brand:"STOUT", name:"–ù–∞—Å–æ—Å 25/60-130", price:12666} ],
        hydro_arrow: {id:"SDG-0015-004001", name:"–ì–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–µ–ª–∫–∞ 3 –º3/—á–∞—Å", price:22082},
        hydro_modular_dn20: [
            {id:"SDG-0016-002502", name:"–°—Ç–∞–ª—å–Ω–æ–π —Ä–∞—Å–ø—Ä. –∫–æ–ª–ª–µ–∫—Ç–æ—Ä 2 –∫–æ–Ω—Ç—É—Ä–∞ DN20", price:26395},
            {id:"SDG-0016-002503", name:"–°—Ç–∞–ª—å–Ω–æ–π —Ä–∞—Å–ø—Ä. –∫–æ–ª–ª–µ–∫—Ç–æ—Ä 3 –∫–æ–Ω—Ç—É—Ä–∞ DN20", price:29180}
        ],
        mats: [ {id:"SMF-0001-110802", name:"–ú–∞—Ç —Å –±–æ–±—ã—à–∫–∞–º–∏ STOUT", area:0.88, price:991, brand:"STOUT"} ],
        xps_kit: [
            {id:"418318", name:"XPS –¢–µ—Ö–Ω–æ–Ω–∏–∫–æ–ª—å Carbon Eco 50–º–º (1180—Ö580)", area:0.6844, price:299, brand:"Technonicol"},
            {id:"138605", name:"–î—é–±–µ–ª—å —Ç–∞—Ä–µ–ª—å—á–∞—Ç—ã–π 10—Ö100 (–£–ø. 100 —à—Ç)", price:936, brand:"Tech-Krep"},
            {id:"SMF-0005-251620", name:"–°–∫–æ–±—ã —è–∫–æ—Ä–Ω—ã–µ –¥–ª—è —Ç–∞–∫–µ—Ä–∞ (–ö–∞—Å—Å–µ—Ç–∞ 25 —à—Ç)", price:121, brand:"STOUT"},
            {id:"160028", name:"–õ–µ–Ω—Ç–∞ –º–æ–Ω—Ç–∞–∂–Ω–∞—è X-Glass –¢–ü–õ –∞—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 50—Ö50–º", price:236, brand:"X-Glass"}
        ],
        american_34: {id:"SFT-0041-000034", name:"–†–∞–∑—ä–µ–º–Ω–æ–µ —Å–æ–µ–¥. –∞–º–µ—Ä–∏–∫–∞–Ω–∫–∞ –í–ù 3/4\"", price:597},
        ball_valve_34: {id:"SVB-0004-000020", name:"–ö—Ä–∞–Ω —à–∞—Ä–æ–≤–æ–π –í–†/–ù–†, 3/4\"", price:1090},
        check_valve_34: {id:"SVC-0011-000020", name:"–ö–ª–∞–ø–∞–Ω –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä—É–∂–∏–Ω–Ω—ã–π 3/4\"", price:1446},
        filter_mag: {id:"SFW-0072-000020", name:"–§–∏–ª—å—Ç—Ä-—à–ª–∞–º–æ–æ—Ç–¥–µ–ª–∏—Ç–µ–ª—å –º–∞–≥–Ω–∏—Ç–Ω—ã–π 3/4\"", price:7720},
        nipple_34: {id:"SFT-0003-003434", name:"–ù–∏–ø–ø–µ–ª—å –ù–ù 3/4\"", price:200},
        coolants: [ {id:"WARME-HYDRO-20", brand:"WARME", name:"Hydro, 20–ª", vol:20, price:950, type:"water"}, {id:"WARME-ECO30-20", brand:"WARME", name:"Eco 30, 20–∫–≥", vol:19, price:3492, type:"eco30"}, {id:"WARME-PRO65-20", brand:"WARME", name:"Eco Pro 65, 20–∫–≥", vol:18, price:4968, type:"pro65"} ],
        // === –í–û–î–û–°–ù–ê–ë–ñ–ï–ù–ò–ï (–ù–û–í–û–ï, –ü–û –°–ö–†–ò–ù–®–û–¢–ê–ú) ===
        // –í–û–î–û–°–ù–ê–ë–ñ–ï–ù–ò–ï: –¢–†–£–ë–´ –ò –ò–ó–û–õ–Ø–¶–ò–Ø
        water_pipes: [
            { id: "SPX-0001-001622", name: "–¢—Ä—É–±–∞ PEX-a 16x2.2 (—Å–µ—Ä–∞—è)", price: 197.47, unit: "–º" }, 
            { id: "SPX-0001-002028", name: "–¢—Ä—É–±–∞ PEX-a 20x2.8 (—Å–µ—Ä–∞—è)", price: 295.09, unit: "–º" },
            { id: "SPX-0001-002535", name: "–¢—Ä—É–±–∞ PEX-a 25x3.5 (—Å–µ—Ä–∞—è)", price: 457.78, unit: "–º" },
            { id: "SPX-0001-003244", name: "–¢—Ä—É–±–∞ PEX-a 32x4.4 (—Å–µ—Ä–∞—è)", price: 743.89, unit: "–º" }
        ],
        water_insulation: [
            { id: "EFXT018092SUPRK", name: "–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è 18/9 (–ö—Ä–∞—Å–Ω–∞—è)", price: 33.67, unit: "–º", brand:"Energoflex" },
            { id: "EFXT018092SUPRS", name: "–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è 18/9 (–°–∏–Ω—è—è)", price: 33.67, unit: "–º", brand:"Energoflex" }
        ],

        // –í–û–î–û–°–ù–ê–ë–ñ–ï–ù–ò–ï: –§–ò–¢–ò–ù–ì–ò
        water_fittings: [
            { id: "SFA-0032-001612", name: "–í–æ–¥–æ—Ä–æ–∑–µ—Ç–∫–∞ 16x1/2\" (—Ç—É–ø–∏–∫–æ–≤–∞—è)", price: 865.92 },
            { id: "SFA-0040-001612", name: "–£–≥–æ–ª—å–Ω–∏–∫ –ø—Ä–æ—Ç–æ—á–Ω—ã–π 16x1/2\" (–ë—Ä–æ–Ω–∑–∞)", price: 2838.94 },
            { id: "SFA-0039-002012", name: "–£–≥–æ–ª—å–Ω–∏–∫ –ø—Ä–æ—Ç–æ—á–Ω—ã–π 20x1/2\" (–ø—Ä–æ—Ö–æ–¥–Ω–∞—è)", price: 2698.83 },
            { id: "SFA-0027-252525", name: "–ö—Ä–æ–Ω—à—Ç–µ–π–Ω –º–æ–Ω—Ç–∞–∂–Ω—ã–π (75/150)", price: 895 }, 
            { id: "SFA-0035-100012", name: "–ü—Ä–æ–±–∫–∞ —Å –Ω–∞—Ä—É–∂–Ω–µ–π —Ä–µ–∑—å–±–æ–π (–°–∏–Ω—è—è)", price: 29.82 },
            { id: "SFA-0035-200012", name: "–ü—Ä–æ–±–∫–∞ —Å –Ω–∞—Ä—É–∂–Ω–µ–π —Ä–µ–∑—å–±–æ–π (–ö—Ä–∞—Å–Ω–∞—è)", price: 29.82 },
            { id: "SFA-0031-000016", name: "–§–∏–∫—Å–∞—Ç–æ—Ä –ø–æ–≤–æ—Ä–æ—Ç–∞ 90¬∞ (14-18 –º–º)", price: 89.89 },
            { id: "SFA-0031-000120", name: "–§–∏–∫—Å–∞—Ç–æ—Ä –ø–æ–≤–æ—Ä–æ—Ç–∞ 90¬∞ (20 –º–º)", price: 142.53 },
            { id: "SMF-0003-028032", name: "–î—é–±–µ–ª—å-–∫—Ä—é–∫ –¥–≤–æ–π–Ω–æ–π", price: 7.09 }
        ],

        // === –ö–û–õ–õ–ï–ö–¢–û–†–´ SMB 6851 (–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ) ===
        water_manifolds_cold: [
            { id: "SMB-6851-343402", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x2 –≤—ã—Ö.", loops: 2, price: 1962.10 },
            { id: "SMB-6851-343403", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x3 –≤—ã—Ö.", loops: 3, price: 2735.63 },
            { id: "SMB-6851-343404", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x4 –≤—ã—Ö.", loops: 4, price: 3686.22 }
        ],
        water_manifolds_hot: [
            { id: "SMB-6851-343402", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x2 –≤—ã—Ö.", loops: 2, price: 1962.10 },
            { id: "SMB-6851-343403", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x3 –≤—ã—Ö.", loops: 3, price: 2735.63 },
            { id: "SMB-6851-343404", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x4 –≤—ã—Ö.", loops: 4, price: 3686.22 }
        ],
        water_manifolds_recirc: [
            { id: "SMB-6851-343402", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x2 –≤—ã—Ö.", loops: 2, price: 1962.10 },
            { id: "SMB-6851-343403", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x3 –≤—ã—Ö.", loops: 3, price: 2735.63 },
            { id: "SMB-6851-343404", name: "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä 3/4\"x4 –≤—ã—Ö.", loops: 4, price: 3686.22 }
        ],
        water_parts: [
            { id: "SFC-0020-001622", name: "–ï–≤—Ä–æ–∫–æ–Ω—É—Å 16x2.2 (–¥–ª—è –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞)", price: 381.76 },
            { id: "SFC-0020-002028", name: "–ï–≤—Ä–æ–∫–æ–Ω—É—Å 20x2.8 (–¥–ª—è –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞)", price: 390.30 },
            { id: "SFT-0024-000034", name: "–ó–∞–≥–ª—É—à–∫–∞ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞ 3/4\" (HP)", price: 158.50 },
            { id: "SFA-0037-300000", name: "–ù–∞–∫–ª–µ–π–∫–∏ \"–í–û–î–û–°–ù–ê–ë–ñ–ï–ù–ò–ï\"", price: 872.84 },
            { id: "SFA-0035-100016", name: "–ó–∞—â–∏—Ç–Ω–∞—è –≤—Ç—É–ª–∫–∞ —Å–∏–Ω—è—è 16–º–º", price: 51.96 },
            { id: "SFA-0035-200016", name: "–ó–∞—â–∏—Ç–Ω–∞—è –≤—Ç—É–ª–∫–∞ –∫—Ä–∞—Å–Ω–∞—è 16–º–º", price: 51.96 },
            { id: "M571-VE-01", name: "–ò–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—è —Å –∫–Ω–æ–ø–∫–æ–π —Ö—Ä–æ–º –≥–ª—è–Ω—Ü–µ–≤–∞—è –∏ —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏–µ–π", price: 32409, brand: "AlcaPlast" },
            { id: "SFA-0020-000016", name: "–ì–∏–ª—å–∑–∞ –º–æ–Ω—Ç–∞–∂–Ω–∞—è 16 (–∞–∫—Å–∏–∞–ª—å–Ω–∞—è)", price: 109, brand: "STOUT" }
        ]
    };

    const titanRads = [];
    const titanData = { 4: 10092, 5: 11724, 6: 13356, 7: 14988, 8: 16620, 9: 18252, 10: 19884, 11: 21516, 12: 23148, 13: 24780, 14: 26412 };
    for(let s=4; s<=14; s++) {
        let idNum = s.toString().padStart(2, '0');
        titanRads.push({ id: `SRB-3320-0500${idNum}`, name: `–†–∞–¥–∏–∞—Ç–æ—Ä TITAN ${s} —Å–µ–∫—Ü–∏–π`, sec: s, price: titanData[s] || 0, brand: 'STOUT', power50: 128, passportPower: 198 });
    }

    const steelData22 = [ {len: 400, p70: 958, price: 6739}, {len: 500, p70: 1163, price: 7530}, {len: 600, p70: 1368, price: 8419}, {len: 700, p70: 1573, price: 9229}, {len: 800, p70: 1778, price: 10118}, {len: 900, p70: 2038, price: 10905}, {len: 1000, p70: 2265, price: 11778}, {len: 1100, p70: 2491, price: 13109}, {len: 1200, p70: 2718, price: 13939}, {len: 1300, p70: 2944, price: 14824}, {len: 1400, p70: 3171, price: 15824}, {len: 1500, p70: 3397, price: 16663}, {len: 1600, p70: 3624, price: 17884}, {len: 1800, p70: 4076, price: 20738}, {len: 2000, p70: 4529, price: 23406}, {len: 2200, p70: 4982, price: 25341}, {len: 2400, p70: 5436, price: 27522}, {len: 2600, p70: 5889, price: 30301}, {len: 2800, p70: 6342, price: 32566}, {len: 3000, p70: 6795, price: 34584} ];
    const steelData21 = [ {len: 400, p70: 680, price: 5900}, {len: 500, p70: 850, price: 6500}, {len: 600, p70: 1020, price: 7100}, {len: 700, p70: 1190, price: 7800}, {len: 800, p70: 1360, price: 8500}, {len: 900, p70: 1530, price: 9200}, {len: 1000, p70: 1700, price: 9900} ];
    const steelRads = [ ...steelData21.map(x => ({ type: 21, ...x })), ...steelData22.map(x => ({ type: 22, ...x })) ].map(x => {
        let lenCode = (x.len / 10).toString().padStart(3, '0');
        return { id: `RRS-2020-${x.type}5${lenCode}`, name: `–°—Ç–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª—å–Ω—ã–π —Ä–∞–¥–∏–∞—Ç–æ—Ä, Ventil (–¢–∏–ø ${x.type})`, sec: x.len, isPanel: true, price: x.price, brand: 'ROMMER', power50: Math.round(x.p70 * Math.pow(50/70, 1.3)), passportPower: x.p70 };
    }).sort((a, b) => a.power50 - b.power50);

    const app = {
        // systems: [] - –∑–Ω–∞—á–∏—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        state: { area:150, floors:1, region:130, mat:1.0, fuels:['el'], systems:[], hotWater:false, recirc:false, res:3, win:4, tp1:0, tp2:0, showSku:false, coolant:'water', mergeItems: true, collapsedGroups: [], swaps: {}, showSwapFor: null, radType: 'space', headType: 'gas', connectionType: 'angled', boilerType: 'optibase', ufhZones: 1, ufhCtrl: 'mech', pumpType: 'default', boilerSeries: 'plus', hydroType: 'combo', pipeType: 'insulated', ufhBaseType: 'mat', radManifoldType: 'standard', water: false, waterZones: [], ufhAuto: false, projectName: "" },
        
        // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–µ–Ω–∏ –ø—Ä–æ–µ–∫—Ç–∞
        setProjectName: function(val) { this.state.projectName = val.trim(); this.saveState(); },
        
        // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏
        toggleUfhAuto: function(chk) { this.state.ufhAuto = chk; this.syncUI(); this.render(); },

        toggleGroup: function(name) {
            const idx = this.state.collapsedGroups.indexOf(name);
            if (idx === -1) this.state.collapsedGroups.push(name);
            else this.state.collapsedGroups.splice(idx, 1);
            this.render();
        },
        toggleMerge: function() { this.state.mergeItems = document.getElementById('chk_merge').checked; this.render(); },
        download: function() { window.print(); },
        sendTg: function() {
            const myLogin = "dima_ibatullin"; 
            let s = document.getElementById('total_sum').innerText;
            let a = this.state.area;
            let f = this.state.floors;
            let fuel = this.state.fuels.includes('gas') ? '–ì–∞–∑' : '–≠–ª–µ–∫—Ç—Ä–æ';
            let settings = JSON.stringify(this.state);
            let text = `üëã *–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ —Å —Å–∞–π—Ç–∞!* \n`;
            text += `‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ\n`;
            text += `üè† –û–±—ä–µ–∫—Ç: ${a} –º¬≤ (${f === 2 ? '2 —ç—Ç–∞–∂–∞' : '1 —ç—Ç–∞–∂'})\n`;
            text += `üî• –°–∏—Å—Ç–µ–º–∞: ${fuel}\n`;
            text += `üí∞ –ò–¢–û–ì–û: **${s}**\n`;
            text += `‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ\n`;
            text += `üëá *–ö–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–Ω–∞–∂–º–∏, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å):*\n`;
            text += `\`${settings}\` \n\n`;
            text += `–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç.`;
            let url = `https://t.me/${myLogin}?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        },
        loadFromCode: function() {
            let code = prompt("–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å { ):");
            if (code) {
                try {
                    let cleanCode = code.replace(/`/g, '').trim();
                    let savedState = JSON.parse(cleanCode);
                    this.state = { ...this.state, ...savedState };
                    this.syncUI();
                    this.render();
                } catch (e) {
                    alert("–û—à–∏–±–∫–∞! –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞.");
                }
            }
        },
        // === –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –°–ë–†–û–°–ê ===
        reset: function() {
            if(!confirm("–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞—á–∞—Ç—å —Ä–∞—Å—á–µ—Ç –∑–∞–Ω–æ–≤–æ?")) return;
            
            // 1. –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å (systems: [] - –ø—É—Å—Ç–æ)
            this.state = { 
                area:150, floors:1, region:130, mat:1.0, fuels:['el'], systems:[], 
                hotWater:false, recirc:false, res:3, win:4, tp1:0, tp2:0, 
                showSku:false, coolant:'water', mergeItems: true, collapsedGroups: [], 
                swaps: {}, showSwapFor: null, radType: 'space', headType: 'gas', 
                connectionType: 'angled', boilerType: 'optibase', ufhZones: 1, 
                ufhCtrl: 'mech', pumpType: 'default', boilerSeries: 'plus', 
                hydroType: 'combo', pipeType: 'insulated', ufhBaseType: 'mat', 
                radManifoldType: 'standard', water: false, waterZones: [], ufhAuto: false, projectName: "" 
            };

            // 2. –û—á–∏—â–∞–µ–º –ø–∞–º—è—Ç—å –±—Ä–∞—É–∑–µ—Ä–∞
            localStorage.removeItem('stout_save');

            // 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ –∏ –ø–æ–ª—è
            this.syncUI();
            this.render();
        },
        // =============================
        saveState: function() { localStorage.setItem('stout_save', JSON.stringify(this.state)); },
        init: function() { 
            if (localStorage.getItem('stout_save')) {
                try { this.state = { ...this.state, ...JSON.parse(localStorage.getItem('stout_save')) }; } catch (e) { console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è", e); }
            }
            let radAlts = [catalog.rads[0], titanRads[0], steelRads[0]];
            catalog.rads.forEach(rad => { rad.alts = radAlts; }); titanRads.forEach(rad => { rad.alts = radAlts; }); steelRads.forEach(rad => { rad.alts = radAlts; });
            let hAlts = catalog.h_valves; catalog.h_valves.forEach(v => { v.alts = hAlts; });
            let boilerAlts = [catalog.tanks_optibase[0], catalog.tanks_standard[0]]; catalog.tanks_optibase.forEach(t => { t.alts = boilerAlts; }); catalog.tanks_standard.forEach(t => { t.alts = boilerAlts; });
            let pumpAlts = catalog.pumps_dn25; catalog.pumps_dn25.forEach(p => { p.alts = pumpAlts; });
            let elBoilerAlts = [catalog.boilers_plus[0], catalog.boilers_status[0]]; catalog.boilers_plus.forEach(b => { b.alts = elBoilerAlts; }); catalog.boilers_status.forEach(b => { b.alts = elBoilerAlts; });
            let hydroAlts = catalog.hydro_modular_dn20; catalog.hydro_dn20.forEach(h => { h.alts = hydroAlts; }); catalog.hydro_modular_dn20.forEach(h => { h.alts = catalog.hydro_dn20; });
            let pipeAlts = catalog.rad_pipes_grey; catalog.insulated_pipes.forEach(p => { p.alts = pipeAlts; }); catalog.rad_pipes_grey.forEach(p => { p.alts = catalog.insulated_pipes; });
            if (catalog.manifolds_rad && catalog.manifolds_chrome_blocks) { let chromeAlt = catalog.manifolds_chrome_blocks[0]; catalog.manifolds_rad.forEach(m => { m.alts = [chromeAlt]; }); catalog.manifolds_chrome_blocks.forEach(m => { m.alts = [catalog.manifolds_rad[0]]; }); }
            let xpsAlt = catalog.xps_kit[0]; catalog.mats.forEach(m => { m.alts = [xpsAlt]; }); catalog.xps_kit[0].alts = catalog.mats;
            this.syncUI(); this.render(); 
        },
        toggleSwapUI: function(id) { if (this.state.showSwapFor === id) { this.state.showSwapFor = null; } else { this.state.showSwapFor = id; } this.render(); },
        cycleSwap: function(originalId) {
            let isRad = (catalog.rads.find(x=>x.id===originalId) || titanRads.find(x=>x.id===originalId) || steelRads.find(x=>x.id===originalId));
            if (isRad) { if (this.state.radType === 'space') this.state.radType = 'titan'; else if (this.state.radType === 'titan') this.state.radType = 'steel'; else this.state.radType = 'space'; } 
            else if ((originalId.startsWith('SHT') || (originalId.startsWith('STE') && originalId.includes('2070'))) && !originalId.includes('2001') && !originalId.includes('2002')) { if (this.state.headType === 'gas') this.state.headType = 'liquid'; else if (this.state.headType === 'liquid') this.state.headType = 'smart'; else this.state.headType = 'gas'; }
            else if (originalId.startsWith('SVH')) { if (this.state.connectionType === 'angled') this.state.connectionType = 'straight'; else this.state.connectionType = 'angled'; }
            else if (originalId.startsWith('SWH')) { this.state.boilerType = (this.state.boilerType === 'optibase') ? 'standard' : 'optibase'; }
            else if (originalId.startsWith('SPC-') && originalId.includes('180')) { if (this.state.pumpType === 'default') this.state.pumpType = 'std'; else if (this.state.pumpType === 'std') this.state.pumpType = 'mini'; else if (this.state.pumpType === 'mini') this.state.pumpType = 'pro'; else this.state.pumpType = 'default'; }
            else if (originalId.startsWith('SEB-')) { this.state.boilerSeries = (this.state.boilerSeries === 'plus') ? 'status' : 'plus'; }
            else if (originalId.startsWith('SDG-0018') || originalId.startsWith('SDG-0016')) { this.state.hydroType = (this.state.hydroType === 'combo') ? 'modular' : 'combo'; }
            else if (originalId.startsWith('SMS-0922') || originalId.startsWith('SMB-6850')) { this.state.radManifoldType = (this.state.radManifoldType === 'standard') ? 'chrome' : 'standard'; }
            else if (originalId.startsWith('SPI-') || originalId.startsWith('SPX-')) { this.state.pipeType = (this.state.pipeType === 'insulated') ? 'split' : 'insulated'; }
            else if (originalId.startsWith('SMF-0001') || originalId === '418318') { this.state.ufhBaseType = (this.state.ufhBaseType === 'mat') ? 'xps' : 'mat'; }
            this.state.showSwapFor = null; this.render();
        },
        setUfhCtrl: function(type) { this.state.ufhCtrl = type; this.syncUI(); this.render(); },
        updZones: function(d) { let n=this.state.ufhZones+d; if(n<1)n=1; if(n>16)n=16; this.state.ufhZones=n; this.syncUI(); this.render(); },
        syncUI: function() {
            document.getElementById('inp_area').value = this.state.area; document.getElementById('val_area').innerText = this.state.area; document.getElementById('val_win').innerText = this.state.win; document.getElementById('chk_floors').checked = (this.state.floors===2); document.getElementById('div_tp2').style.display = (this.state.floors===2)?'block':'none';
            document.getElementById('fuel_el').className = this.state.fuels.includes('el') ? 'tab multi-active' : 'tab'; document.getElementById('fuel_gas').className = this.state.fuels.includes('gas') ? 'tab multi-active' : 'tab';
            const hasTp = this.state.systems.includes('tp'); document.getElementById('sys_rad').className = this.state.systems.includes('rad') ? 'tab multi-active' : 'tab'; document.getElementById('sys_tp').className = hasTp ? 'tab multi-active' : 'tab';
            document.getElementById('blk_tp_sliders').style.display = hasTp ? 'block' : 'none'; document.getElementById('blk_ufh_ctrl').style.display = hasTp ? 'block' : 'none';
            document.getElementById('chk_hw').checked = this.state.hotWater; document.getElementById('blk_res').style.display = this.state.hotWater?'flex':'none'; document.getElementById('val_res').innerText = this.state.res; document.getElementById('val_zones').innerText = this.state.ufhZones;
            const ufhTabs = document.querySelectorAll('.ufh-tab'); ufhTabs.forEach(t => { t.className = 'tab ufh-tab'; if(t.dataset.type === this.state.ufhCtrl) t.classList.add('multi-active'); });
            const regTabs = document.getElementById('reg_tabs').children; for(let t of regTabs) t.classList.remove('active');
            if(this.state.region===130) regTabs[0].classList.add('active'); if(this.state.region===120) regTabs[1].classList.add('active'); if(this.state.region===100) regTabs[2].classList.add('active'); if(this.state.region===60) regTabs[3].classList.add('active');
            const matTabs = document.getElementById('mat_tabs').children; for(let t of matTabs) t.classList.remove('active');
            if(this.state.mat===1.3) matTabs[0].classList.add('active'); if(this.state.mat===1.0) matTabs[1].classList.add('active'); if(this.state.mat===0.8) matTabs[2].classList.add('active');
            const cTabs = document.querySelectorAll('.cool-tab'); cTabs.forEach(t => { t.classList.remove('active'); if(t.dataset.type === this.state.coolant) t.classList.add('active'); });
            document.getElementById('inp_tp1').max = this.state.area; document.getElementById('inp_tp2').max = this.state.area; document.getElementById('inp_tp1').value = this.state.tp1; document.getElementById('val_tp1').innerText = this.state.tp1; document.getElementById('inp_tp2').value = this.state.tp2; document.getElementById('val_tp2').innerText = this.state.tp2;
            document.getElementById('chk_sku').checked = this.state.showSku;
            if(document.getElementById('chk_hw')) document.getElementById('chk_hw').checked = this.state.hotWater;
            if(document.getElementById('chk_recirc')) document.getElementById('chk_recirc').checked = this.state.recirc;
            if(document.getElementById('chk_water')) document.getElementById('chk_water').checked = this.state.water;
            if(document.getElementById('blk_water_zones')) document.getElementById('blk_water_zones').style.display = this.state.water ? 'flex' : 'none';
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ê–≤—Ç–æ–º–∞—Ç–∏–∫–∏ –¢–ü
            if(document.getElementById('chk_ufh_auto')) document.getElementById('chk_ufh_auto').checked = this.state.ufhAuto;
            if(document.getElementById('blk_ufh_settings')) document.getElementById('blk_ufh_settings').style.display = this.state.ufhAuto ? 'block' : 'none';
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏
            if(document.getElementById('project_name_edit')) document.getElementById('project_name_edit').innerText = this.state.projectName;

            this.renderZonesUI(); 
            this.updateInfo();
        },
        setArea: function(v) { 
            v=parseInt(v); this.state.area=v; if(this.state.tp1>v)this.state.tp1=v; if(this.state.tp1+this.state.tp2>v)this.state.tp2=v-this.state.tp1; 
            
            // –ì–∏–±–∫–∏–π —Ä–∞—Å—á–µ—Ç —Ç—Ä–∞—Å—Å—ã: –ö–æ—Ä–µ–Ω—å –∏–∑ (–ü–ª–æ—â–∞–¥—å / –≠—Ç–∞–∂–∏)
            let footprint = this.state.area / (this.state.floors === 2 ? 2 : 1);
            let newDist = Math.ceil(Math.sqrt(footprint)); 
            
            this.state.waterZones.forEach(z => z.dist = newDist);
            
            this.syncUI(); this.render(); 
        },
        updWin: function(d) { let n=this.state.win+d; if(n<1)n=1; this.state.win=n; this.syncUI(); this.render(); },
        toggleFloors: function(chk) { 
            this.state.floors=chk?2:1; if(!chk)this.state.tp2=0; 
            
            // –ü–µ—Ä–µ—Å—á–µ—Ç —Ç—Ä–∞—Å—Å—ã –ø—Ä–∏ —Å–º–µ–Ω–µ —ç—Ç–∞–∂–Ω–æ—Å—Ç–∏
            let footprint = this.state.area / (this.state.floors === 2 ? 2 : 1);
            let newDist = Math.ceil(Math.sqrt(footprint));
            
            this.state.waterZones.forEach(z => z.dist = newDist);
            
            this.syncUI(); this.render(); 
        },
        setRegion: function(v) { this.state.region=v; this.syncUI(); this.render(); },
        setMat: function(v) { this.state.mat=v; this.syncUI(); this.render(); },
        updateInfo: function() { document.getElementById('desc_reg').innerHTML = `<span>üìç</span> ${REGION_DESC[this.state.region]}`; document.getElementById('desc_mat').innerHTML = `<span>üß±</span> ${WALL_DESC[this.state.mat]}`; },
        toggleFuel: function(f) { let idx = this.state.fuels.indexOf(f); if (idx > -1) { if (this.state.fuels.length > 1) this.state.fuels.splice(idx, 1); } else { this.state.fuels.push(f); } this.syncUI(); this.render(); },
        toggleSys: function(s) { let i=this.state.systems.indexOf(s); if(i>-1){ if(this.state.systems.length>1) this.state.systems.splice(i,1); } else this.state.systems.push(s); this.syncUI(); this.render(); },
        toggleHW: function(chk) { this.state.hotWater = chk; this.render(); }, 
        toggleRecirc: function(chk) { this.state.recirc = chk; this.render(); },
        toggleWater: function(chk) { this.state.water = chk; if(chk && this.state.waterZones.length===0) this.addZone(); this.syncUI(); this.render(); },
        addZone: function() {
            let id = Date.now();
            // –†–∞—Å—á–µ—Ç –¥–ª—è –Ω–æ–≤–æ–π –∑–æ–Ω—ã
            let footprint = this.state.area / (this.state.floors === 2 ? 2 : 1);
            let dist = Math.ceil(Math.sqrt(footprint));
            
            this.state.waterZones.push({ id: id, name: "–°–∞–Ω—É–∑–µ–ª " + (this.state.waterZones.length+1), dist: dist, fixtures: { toilet:0, basin:0, shower:0, wash:0, dish:0 } });
            this.syncUI(); this.render();
        },
        removeZone: function(id) { this.state.waterZones = this.state.waterZones.filter(z => z.id !== id); this.syncUI(); this.render(); },
        updZoneFixture: function(id, type, delta) {
            let z = this.state.waterZones.find(x => x.id === id);
            if(z) { z.fixtures[type] += delta; if(z.fixtures[type] < 0) z.fixtures[type] = 0; }
            this.renderZonesUI(); this.render();
        },
        updZoneDist: function(id, val) {
            let z = this.state.waterZones.find(x => x.id === id);
            if(z) z.dist = parseInt(val) || 0;
            this.render();
        },
        renderZonesUI: function() {
            const container = document.getElementById('zones_list');
            if(!container) return;
            container.innerHTML = "";
            const labels = { toilet: "üöΩ –£–Ω–∏—Ç–∞–∑", basin: "üö∞ –†–∞–∫–æ–≤–∏–Ω–∞", shower: "üöø –î—É—à", wash: "üß∫ –°—Ç–∏—Ä–∞–ª–∫–∞", dish: "üçΩÔ∏è –ü–ú–ú" };
            this.state.waterZones.forEach((z, idx) => {
                let itemsHtml = "";
                for(let [key, name] of Object.entries(labels)) {
                    itemsHtml += `<div class="zone-row"><span style="font-size:11px;">${name}</span><div class="stepper" style="width:70px; height:24px;"><button class="step-btn" onclick="app.updZoneFixture(${z.id}, '${key}', -1)">‚àí</button><div class="step-val" style="font-size:11px;">${z.fixtures[key]}</div><button class="step-btn" onclick="app.updZoneFixture(${z.id}, '${key}', 1)">+</button></div></div>`;
                }
                let html = `<div class="zone-card"><div class="zone-header"><span class="zone-title" contenteditable="true" onblur="app.state.waterZones[${idx}].name=this.innerText">${z.name}</span><div class="zone-remove" onclick="app.removeZone(${z.id})">√ó</div></div><div style="margin-bottom:10px; font-size:11px; display:flex; align-items:center; gap:5px;"><span>–¢—Ä–∞—Å—Å–∞ (–º):</span><input type="number" class="zone-input" value="${z.dist}" onchange="app.updZoneDist(${z.id}, this.value)"></div>${itemsHtml}</div>`;
                container.insertAdjacentHTML('beforeend', html);
            });
        },
        updRes: function(d) { let n=this.state.res+d; if(n<1)n=1; if(n>10)n=10; this.state.res=n; this.syncUI(); this.render(); },
        updTp: function(f, v) { v = parseInt(v); let max = this.state.area; if (f === 1) { if (v > max) v = max; this.state.tp1 = v; if (this.state.tp1 + this.state.tp2 > max) this.state.tp2 = max - this.state.tp1; } else { if (v > max) v = max; this.state.tp2 = v; if (this.state.tp1 + this.state.tp2 > max) this.state.tp1 = max - this.state.tp2; } this.syncUI(); this.render(); },
        setCoolant: function(t) { this.state.coolant=t; this.syncUI(); this.render(); },
        toggleSku: function() {
            this.state.showSku = document.getElementById('chk_sku').checked;
            const panel = document.querySelector('.output-panel');
            if (this.state.showSku) panel.classList.add('show-sku-mode'); else panel.classList.remove('show-sku-mode');
            this.render();
        },

        // === –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ü–û–î–°–ö–ê–ó–û–ö ===
        getDesc: function(type, val1, val2) {
            const styles = "font-size:11px; line-height:1.4;";
            const head = "font-weight:700; color:#93C5FD; display:block; margin-bottom:4px;";
            
            // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–æ–≤
            if (type === 'manifold') {
                let formula = "";
                let why = "–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–µ—Ç–µ–ª—å.";
                if (val2 === 'cw') {
                    formula = `<b>–¢–∏–ø:</b> –•–í–° (–•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞).<br><b>–§–æ—Ä–º—É–ª–∞:</b> –°—É–º–º–∞ –≤—Å–µ—Ö –≤–æ–¥–æ—Ä–∞–∑–µ—Ç–æ–∫.<br><b>–ò—Ç–æ–≥–æ —Ç–æ—á–µ–∫:</b> ${val1}.`;
                } else if (val2 === 'hw_std') {
                    formula = `<b>–¢–∏–ø:</b> –ì–í–° (–¢—É–ø–∏–∫–æ–≤–∞—è).<br><b>–§–æ—Ä–º—É–ª–∞:</b> –°—É–º–º–∞ –ø—Ä–∏–±–æ—Ä–æ–≤ —Å –≥–æ—Ä—è—á–µ–π –≤–æ–¥–æ–π.<br><b>–ò—Ç–æ–≥–æ —Ç–æ—á–µ–∫:</b> ${val1}.`;
                } else if (val2 === 'hw_recirc') {
                    formula = `<b>–¢–∏–ø:</b> –ì–í–° (–õ—É—á–µ–≤–∞—è).<br><b>–§–æ—Ä–º—É–ª–∞:</b> 1 –≤—ã—Ö–æ–¥ –Ω–∞ 1 –∑–æ–Ω—É (—Å–∞–Ω—É–∑–µ–ª/–∫—É—Ö–Ω—é).<br><b>–ò—Ç–æ–≥–æ –ø–µ—Ç–µ–ª—å:</b> ${val1}.`;
                } else if (val2 === 'recirc') {
                    formula = `<b>–¢–∏–ø:</b> –†–µ—Ü–∏—Ä–∫—É–ª—è—Ü–∏—è.<br><b>–§–æ—Ä–º—É–ª–∞:</b> –†–∞–≤–Ω–æ —á–∏—Å–ª—É –ø–µ—Ç–µ–ª—å –ì–í–°.<br><b>–ò—Ç–æ–≥–æ –ª–∏–Ω–∏–π:</b> ${val1}.`;
                } else if (val2 === 'rad') {
                    formula = `<b>–¢–∏–ø:</b> –†–∞–¥–∏–∞—Ç–æ—Ä–Ω–æ–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ.<br><b>–§–æ—Ä–º—É–ª–∞:</b> 1 –ø–∞—Ä–∞ –≤—ã—Ö–æ–¥–æ–≤ –Ω–∞ 1 —Ä–∞–¥–∏–∞—Ç–æ—Ä.<br><b>–†–∞–¥–∏–∞—Ç–æ—Ä–æ–≤:</b> ${val1} —à—Ç.`;
                } else if (val2 === 'ufh') {
                    formula = `<b>–¢–∏–ø:</b> –¢—ë–ø–ª—ã–π –ø–æ–ª.<br><b>–§–æ—Ä–º—É–ª–∞:</b> –ü–ª–æ—â–∞–¥—å –¢–ü / 12 –º¬≤ (–º–∞–∫—Å. –ø–ª–æ—â–∞–¥—å –æ–¥–Ω–æ–π –ø–µ—Ç–ª–∏).<br><b>–ö–æ–Ω—Ç—É—Ä–æ–≤:</b> ${val1} —à—Ç.`;
                }
                let minWarn = (val1 === 1) ? "<br><br><i>*–í—ã–±—Ä–∞–Ω –±–ª–æ–∫ –Ω–∞ 2 –≤—ã—Ö–æ–¥–∞ (–∑–∞–≤–æ–¥—Å–∫–æ–π –º–∏–Ω–∏–º—É–º). 1 –≤—ã—Ö–æ–¥ ‚Äî —Ä–µ–∑–µ—Ä–≤.</i>" : "";
                return `<span style="${styles}"><span style="${head}">–ö–æ–ª–ª–µ–∫—Ç–æ—Ä–Ω—ã–π –±–ª–æ–∫</span><b>–ó–∞—á–µ–º:</b> ${why}<br><br>${formula}${minWarn}</span>`;
            }

            switch(type) {
                // === 1. –ö–û–¢–ï–õ–¨–ù–ê–Ø ===
                case 'boiler_gas':
                    return `<span style="${styles}"><span style="${head}">–ì–∞–∑–æ–≤—ã–π –∫–æ—Ç–µ–ª</span><b>–ó–∞—á–µ–º:</b> –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç–µ–ø–ª–∞.<br><b>–§–æ—Ä–º—É–ª–∞:</b> (–ü–ª–æ—â–∞–¥—å √ó H_–ø–æ—Ç–æ–ª–∫–æ–≤ √ó –£—Ç–µ–ø–ª–µ–Ω–∏–µ) + 20% –∑–∞–ø–∞—Å.<br><b>–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å:</b> ${val1} –∫–í—Ç.<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –°–ü 60.13330.2020.</span>`;
                case 'boiler_el':
                    return `<span style="${styles}"><span style="${head}">–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π –∫–æ—Ç–µ–ª</span><b>–ó–∞—á–µ–º:</b> –†–µ–∑–µ—Ä–≤–Ω—ã–π –∏–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫.<br><b>–†–∞—Å—á–µ—Ç:</b> –ü–æ —Ç–µ–ø–ª–æ–ø–æ—Ç–µ—Ä—è–º –∑–¥–∞–Ω–∏—è.<br><b>–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å:</b> ${val1} –∫–í—Ç.</span>`;
                case 'boiler_tank':
                    return `<span style="${styles}"><span style="${head}">–ë–æ–π–ª–µ—Ä –∫–æ—Å–≤–µ–Ω–Ω–æ–≥–æ –Ω–∞–≥—Ä–µ–≤–∞</span><b>–ó–∞—á–µ–º:</b> –ö–æ–º—Ñ–æ—Ä—Ç–Ω–æ–µ –ì–í–° (–∑–∞–ø–∞—Å –≤–æ–¥—ã).<br><b>–†–∞—Å—á–µ—Ç:</b> –ö–æ–ª-–≤–æ –∂–∏–ª—å—Ü–æ–≤ (${val1} —á–µ–ª) √ó 50 –ª/—á–µ–ª.<br><b>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –æ–±—ä–µ–º:</b> ${val2} –ª.<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –°–ü 30.13330.2020.</span>`;
                case 'chimney':
                    return `<span style="${styles}"><span style="${head}">–î—ã–º–æ—Ö–æ–¥ –∫–æ–∞–∫—Å–∏–∞–ª—å–Ω—ã–π</span><b>–ó–∞—á–µ–º:</b> –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–±—Ä–æ—Å –≥–∞–∑–æ–≤ –∏ –∑–∞–±–æ—Ä –≤–æ–∑–¥—É—Ö–∞ —Å —É–ª–∏—Ü—ã.<br><b>–°—Ç–∞–Ω–¥–∞—Ä—Ç:</b> 60/100 –º–º (–¥–ª—è —Ç—É—Ä–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ—Ç–ª–æ–≤).<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –°–ü 402.1325800.2018.</span>`;
                case 'stab':
                    return `<span style="${styles}"><span style="${head}">–°—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è</span><b>–ó–∞—á–µ–º:</b> –ó–∞—â–∏—Ç–∞ –¥–æ—Ä–æ–≥–æ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏ –∫–æ—Ç–ª–∞.<br><b>–í–∞–∂–Ω–æ:</b> –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π.</span>`;
                case 'exp_h':
                    return `<span style="${styles}"><span style="${head}">–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ (–û—Ç–æ–ø–ª–µ–Ω–∏–µ)</span><b>–ó–∞—á–µ–º:</b> –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤–æ–¥—ã –ø—Ä–∏ –Ω–∞–≥—Ä–µ–≤–µ.<br><b>–§–æ—Ä–º—É–ª–∞:</b> V_—Å–∏—Å—Ç–µ–º—ã (${val1} –ª) √ó 0.12 (–∫–æ—ç—Ñ—Ñ. —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è).<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –°–ü 41-104-2000.</span>`;
                case 'exp_d':
                    return `<span style="${styles}"><span style="${head}">–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∫ (–ì–í–°)</span><b>–ó–∞—á–µ–º:</b> –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –¥–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–≥—Ä–µ–≤–µ –±–æ–π–ª–µ—Ä–∞.<br><b>–§–æ—Ä–º—É–ª–∞:</b> 10% –æ—Ç –æ–±—ä–µ–º–∞ –±–æ–π–ª–µ—Ä–∞ (${val1} –ª).<br><b>–†–∞—Å—á–µ—Ç:</b> ${val2} –ª.</span>`;
                case 'fugas':
                    return `<span style="${styles}"><span style="${head}">–ö–æ–º–ø–ª–µ–∫—Ç Fugas</span><b>–ó–∞—á–µ–º:</b> –¢—Ä–µ—Ö—Ö–æ–¥–æ–≤–æ–π –∫–ª–∞–ø–∞–Ω –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–æ–π–ª–µ—Ä–∞ –∫ –æ–¥–Ω–æ–∫–æ–Ω—Ç—É—Ä–Ω–æ–º—É –∫–æ—Ç–ª—É.<br><b>–§—É–Ω–∫—Ü–∏—è:</b> –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –ø–æ—Ç–æ–∫ –Ω–∞ –Ω–∞–≥—Ä–µ–≤ –≤–æ–¥—ã –ø–æ –¥–∞—Ç—á–∏–∫—É.</span>`;
                case 'pump_std':
                    return `<span style="${styles}"><span style="${head}">–ù–∞—Å–æ—Å —Ü–∏—Ä–∫—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π</span><b>–ó–∞—á–µ–º:</b> –ü—Ä–æ–∫–∞—á–∫–∞ —Ç–µ–ø–ª–æ–Ω–æ—Å–∏—Ç–µ–ª—è –ø–æ —Å–∏—Å—Ç–µ–º–µ.<br><b>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</b> 25/60 (–ù–∞–ø–æ—Ä 6–º).<br><b>–ü–æ–¥–±–æ—Ä:</b> –ü–æ –≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–æ–º—É —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—é —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π –ø–µ—Ç–ª–∏.</span>`;
                
                // === 3. –†–ê–î–ò–ê–¢–û–†–´ ===
                case 'rad_item':
                    return `<span style="${styles}"><span style="${head}">–†–∞–¥–∏–∞—Ç–æ—Ä –æ—Ç–æ–ø–ª–µ–Ω–∏—è</span><b>–ó–∞—á–µ–º:</b> –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Ç–µ–ø–ª–æ–ø–æ—Ç–µ—Ä—å —á–µ—Ä–µ–∑ –æ–∫–Ω–∞/—Å—Ç–µ–Ω—ã.<br><b>–§–æ—Ä–º—É–ª–∞:</b> –¢–µ–ø–ª–æ–ø–æ—Ç–µ—Ä–∏ –ø–æ–º–µ—â–µ–Ω–∏—è / –¢–µ–ø–ª–æ–æ—Ç–¥–∞—á–∞ —Å–µ–∫—Ü–∏–∏.<br><b>–ú–æ—â–Ω–æ—Å—Ç—å:</b> ${val1} –í—Ç.<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –ì–û–°–¢ 31311-2005.</span>`;
                case 'rad_valves':
                    return `<span style="${styles}"><span style="${head}">–£–∑–µ–ª –Ω–∏–∂–Ω–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</span><b>–ó–∞—á–µ–º:</b> –≠—Å—Ç–µ—Ç–∏—á–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ç—Ä—É–± –∏–∑ —Å—Ç–µ–Ω—ã/–ø–æ–ª–∞.<br><b>–§—É–Ω–∫—Ü–∏—è:</b> –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∫—Ä—ã—Ç—å –∏ —Å–Ω—è—Ç—å —Ä–∞–¥–∏–∞—Ç–æ—Ä –±–µ–∑ —Å–ª–∏–≤–∞ —Å–∏—Å—Ç–µ–º—ã.</span>`;
                case 'rad_head':
                    return `<span style="${styles}"><span style="${head}">–¢–µ—Ä–º–æ–≥–æ–ª–æ–≤–∫–∞</span><b>–ó–∞—á–µ–º:</b> –ö–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª—å –≤ –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç–µ.<br><b>–≠–∫–æ–Ω–æ–º–∏—è:</b> –°–Ω–∏–∂–∞–µ—Ç —Ä–∞—Å—Ö–æ–¥ –≥–∞–∑–∞/—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–∞ –Ω–∞ 15-20% –∑–∞ —Å—á–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–µ—Ä–µ—Ç–æ–ø–∞.</span>`;
                case 'rad_pipe':
                    return `<span style="${styles}"><span style="${head}">–¢—Ä—É–±–∞ (–õ—É—á–µ–≤–∞—è —Ä–∞–∑–≤–æ–¥–∫–∞)</span><b>–ó–∞—á–µ–º:</b> –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ç—Ä–∞—Å—Å–∞ –∫ –∫–∞–∂–¥–æ–º—É —Ä–∞–¥–∏–∞—Ç–æ—Ä—É.<br><b>–§–æ—Ä–º—É–ª–∞:</b> (–°—Ä. —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞ √ó 2) + –ü–æ–¥—ä–µ–º—ã.<br><b>–í—Å–µ–≥–æ:</b> ${val1} –º.</span>`;

                // === 4. –¢–ï–ü–õ–´–ô –ü–û–õ ===
                case 'ufh_pipe':
                    return `<span style="${styles}"><span style="${head}">–¢—Ä—É–±–∞ —Ç–µ–ø–ª–æ–≥–æ –ø–æ–ª–∞</span><b>–ó–∞—á–µ–º:</b> –ì—Ä–µ—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å–∏—Å—Ç–µ–º—ã.<br><b>–§–æ—Ä–º—É–ª–∞:</b> –ü–ª–æ—â–∞–¥—å –ø–æ–ª–∞ √ó 7 –º (–ø—Ä–∏ —à–∞–≥–µ —É–∫–ª–∞–¥–∫–∏ 150 –º–º).<br><b>–û–±—â–∞—è –¥–ª–∏–Ω–∞:</b> ${val1} –º.<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –°–ü 60.13330.2020.</span>`;
                case 'ufh_mat':
                    return `<span style="${styles}"><span style="${head}">–ú–∞—Ç —Å –±–æ–±—ã—à–∫–∞–º–∏</span><b>–ó–∞—á–µ–º:</b> –ë—ã—Å—Ç—Ä—ã–π –º–æ–Ω—Ç–∞–∂ –∏ —Ñ–∏–∫—Å–∞—Ü–∏—è —Ç—Ä—É–±—ã.<br><b>–†–∞—Å—á–µ—Ç:</b> –ß–∏—Å—Ç–∞—è –ø–ª–æ—â–∞–¥—å –¢–ü (${val1} –º¬≤) + 5% –∑–∞–ø–∞—Å –Ω–∞ –ø–æ–¥—Ä–µ–∑–∫—É.</span>`;
                case 'ufh_xps':
                    return `<span style="${styles}"><span style="${head}">–ü–µ–Ω–æ–ø–æ–ª–∏—Å—Ç–∏—Ä–æ–ª (XPS)</span><b>–ó–∞—á–µ–º:</b> –¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è –æ—Ç –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è/–≥—Ä—É–Ω—Ç–∞.<br><b>–¢–æ–ª—â–∏–Ω–∞:</b> 50 –º–º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è 1 —ç—Ç–∞–∂–∞).<br><b>–†–∞—Å—á–µ—Ç:</b> –ü–ª–æ—â–∞–¥—å –¢–ü + 5% –∑–∞–ø–∞—Å.</span>`;
                case 'actuator':
                    return `<span style="${styles}"><span style="${head}">–°–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥</span><b>–ó–∞—á–µ–º:</b> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã–≤–∞–Ω–∏–µ –ø–µ—Ç–µ–ª—å.<br><b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</b> –ü–æ –∫–æ–º–∞–Ω–¥–µ –æ—Ç –∫–æ–º–Ω–∞—Ç–Ω–æ–≥–æ —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∞.<br><b>–ö–æ–ª-–≤–æ:</b> 1 —à—Ç –Ω–∞ –∫–∞–∂–¥—É—é –ø–µ—Ç–ª—é –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞.</span>`;
                case 'thermostat':
                    return `<span style="${styles}"><span style="${head}">–¢–µ—Ä–º–æ—Å—Ç–∞—Ç</span><b>–ó–∞—á–µ–º:</b> –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤–æ–∑–¥—É—Ö–∞ –≤ –∫–æ–º–Ω–∞—Ç–µ.<br><b>–†–∞—Å—á–µ—Ç:</b> 1 —à—Ç –Ω–∞ –æ–¥–Ω—É –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –∑–æ–Ω—É (–∫–æ–º–Ω–∞—Ç—É).</span>`;

                // === 5. –í–û–î–û–°–ù–ê–ë–ñ–ï–ù–ò–ï ===
                case 'pipe_cw':
                    return `<span style="${styles}"><span style="${head}">–¢—Ä—É–±–∞ PEX-a (–•–í–°)</span><b>–ó–∞—á–µ–º:</b> –ü–∏—Ç—å–µ–≤–∞—è —Ö–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞.<br><b>–†–∞—Å—á–µ—Ç:</b> –°—É–º–º–∞ –¥–ª–∏–Ω —Ç—Ä–∞—Å—Å –¥–æ –ø—Ä–∏–±–æ—Ä–æ–≤.<br><b>–í—Å–µ–≥–æ:</b> ${val1} –º.<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –°–ü 30.13330.2020.</span>`;
                case 'pipe_hw':
                    return `<span style="${styles}"><span style="${head}">–¢—Ä—É–±–∞ PEX-a (–ì–í–°)</span><b>–ó–∞—á–µ–º:</b> –ì–æ—Ä—è—á–∞—è –≤–æ–¥–∞ (–¥–æ 95¬∞C).<br><b>–†–∞—Å—á–µ—Ç:</b> –¢—Ä–∞—Å—Å—ã –ø–æ–¥–∞—á–∏ + –ø–æ–¥—ä–µ–º—ã.<br><b>–í—Å–µ–≥–æ:</b> ${val1} –º.</span>`;
                case 'ins_blue':
                    return `<span style="${styles}"><span style="${head}">–ò–∑–æ–ª—è—Ü–∏—è (–°–∏–Ω—è—è)</span><b>–ó–∞—á–µ–º:</b> –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–∞ (—á—Ç–æ–±—ã —Ç—Ä—É–±–∞ –Ω–µ "–ø–æ—Ç–µ–ª–∞").<br><b>–†–∞—Å—á–µ—Ç:</b> –ü–æ –¥–ª–∏–Ω–µ —Ç—Ä—É–±—ã –•–í–° (${val1} –º).<br><b>–ù–æ—Ä–º–∞—Ç–∏–≤:</b> –°–ü 61.13330.2012.</span>`;
                case 'ins_red':
                    return `<span style="${styles}"><span style="${head}">–ò–∑–æ–ª—è—Ü–∏—è (–ö—Ä–∞—Å–Ω–∞—è)</span><b>–ó–∞—á–µ–º:</b> –°–Ω–∏–∂–µ–Ω–∏–µ —Ç–µ–ø–ª–æ–ø–æ—Ç–µ—Ä—å (—á—Ç–æ–±—ã –≤–æ–¥–∞ –Ω–µ –æ—Å—Ç—ã–≤–∞–ª–∞).<br><b>–†–∞—Å—á–µ—Ç:</b> –ü–æ –¥–ª–∏–Ω–µ —Ç—Ä—É–±—ã –ì–í–° (${val1} –º).</span>`;
                case 'socket':
                    return `<span style="${styles}"><span style="${head}">–í–æ–¥–æ—Ä–æ–∑–µ—Ç–∫–∞</span><b>–ó–∞—á–µ–º:</b> –ñ–µ—Å—Ç–∫–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è –≤—ã—Ö–æ–¥–∞ –¥–ª—è —Å–º–µ—Å–∏—Ç–µ–ª—è.<br><b>–¢–∏–ø:</b> ${val1}.<br><b>–ö–æ–ª-–≤–æ:</b> ${val2} —à—Ç.</span>`;
                case 'sleeve':
                    return `<span style="${styles}"><span style="${head}">–ì–∏–ª—å–∑–∞ –º–æ–Ω—Ç–∞–∂–Ω–∞—è</span><b>–ó–∞—á–µ–º:</b> –û–ø—Ä–µ—Å—Å–æ–≤–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–≤–µ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ).<br><b>–†–∞—Å—Ö–æ–¥:</b> ${val1}.</span>`;
                case 'install':
                    return `<span style="${styles}"><span style="${head}">–ò–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—è</span><b>–ó–∞—á–µ–º:</b> –ù–µ—Å—É—â–∞—è —Ä–∞–º–∞ –¥–ª—è –ø–æ–¥–≤–µ—Å–Ω–æ–≥–æ —É–Ω–∏—Ç–∞–∑–∞.<br><b>–ù–∞–≥—Ä—É–∑–∫–∞:</b> –ò—Å–ø—ã—Ç–∞–Ω–æ –Ω–∞ 400 –∫–≥.<br><b>–ö–æ–º–ø–ª–µ–∫—Ç:</b> –†–∞–º–∞, –±–∞—á–æ–∫, –∫–Ω–æ–ø–∫–∞, –∫—Ä–µ–ø–µ–∂.</span>`;
                case 'eurocone_water':
                    return `<span style="${styles}"><span style="${head}">–ï–≤—Ä–æ–∫–æ–Ω—É—Å 16</span><b>–ó–∞—á–µ–º:</b> –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ç—Ä—É–±—ã –∫ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä—É (—Ä–∞–∑–±–æ—Ä–Ω–æ–µ).<br><b>–§–æ—Ä–º—É–ª–∞:</b> 1 —à—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –≤—ã—Ö–æ–¥ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞.<br><b>–ö–æ–ª-–≤–æ:</b> ${val1} —à—Ç.</span>`;
                
                // === 7. –ñ–ò–î–ö–û–°–¢–¨ ===
                case 'coolant':
                    return `<span style="${styles}"><span style="${head}">–¢–µ–ø–ª–æ–Ω–æ—Å–∏—Ç–µ–ª—å</span><b>–ó–∞—á–µ–º:</b> –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.<br><b>–§–æ—Ä–º—É–ª–∞:</b> V_–∫–æ—Ç–ª–æ–≤ + V_—Ä–∞–¥–∏–∞—Ç–æ—Ä–æ–≤ + V_—Ç—Ä—É–± + V_–¢–ü + –ó–∞–ø–∞—Å.<br><b>–û–±—ä–µ–º —Å–∏—Å—Ç–µ–º—ã:</b> ~${val1} –ª.</span>`;

                default: return "";
            }
        },
        // ====================================
        render: function() {
            let pwr = (this.state.area * this.state.region * this.state.mat / 1000).toFixed(1);
            let regionName = "–°–∏–±–∏—Ä—å"; if(this.state.region===120) regionName="–£—Ä–∞–ª"; if(this.state.region===100) regionName="–¶–µ–Ω—Ç—Ä"; if(this.state.region===60) regionName="–Æ–≥";
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
            document.getElementById('doc_summary').innerHTML = `<span>–û–±—ä–µ–∫—Ç: <b>${this.state.area} –º¬≤</b> (${this.state.floors===2?2:1} —ç—Ç)</span> <span class="sep">‚Ä¢</span> <span>–¢–µ–ø–ª–æ–ø–æ—Ç–µ—Ä–∏: <b>${pwr} –∫–í—Ç</b></span> <span class="sep">‚Ä¢</span> <span>–†–µ–≥–∏–æ–Ω: <b>${regionName}</b></span> <span class="sep">‚Ä¢</span> <span>–ü—Ä–æ–∂–∏–≤–∞—é—â–∏—Ö: <b>${this.state.res}</b></span> <span style="margin-left: auto;">–î–∞—Ç–∞: <b>${new Date().toLocaleDateString()}</b></span>`;
            
            let bill = []; 
            const addToBill = (item, qty, tip, group = null) => {
                if(!item || qty <= 0) return;
                let finalItem = item;
                if (this.state.mergeItems) {
                    let existing = bill.find(x => x.id === finalItem.id && x.group === group);
                    if (existing) { existing.q += qty; existing.sum += finalItem.price * qty; if(tip && (!existing.qtyTip || !existing.qtyTip.includes(tip))) existing.qtyTip = existing.qtyTip ? existing.qtyTip + ". " + tip : tip; } 
                    else { bill.push({ ...finalItem, q: qty, sum: finalItem.price * qty, displaySku: finalItem.id, qtyTip: tip || "", group: group, originalId: item.id }); }
                } else {
                    bill.push({ ...finalItem, q: qty, sum: finalItem.price * qty, displaySku: finalItem.id, qtyTip: tip || "", group: group, originalId: item.id });
                }
            };

            let h = "", sum = 0, globalIdx = 1, showSku = document.getElementById('chk_sku').checked;

            const flushBill = (title, warn) => {
                if(bill.length === 0) return;
                let groupTotals = {};
                bill.forEach(i => { if (i.group) { if (!groupTotals[i.group]) groupTotals[i.group] = 0; groupTotals[i.group] += i.sum; } });
                let secTotal = 0, rows = "";
                let titleHtml = title + (warn ? `<div class="warn-box">${warn}</div>` : "");
                h += `<tr class="row-sec"><td colspan="9">${titleHtml}</td></tr>`;
                let lastGroup = null;
                bill.forEach((i, arrIndex) => {
                    secTotal += i.sum;
                    let isCollapsed = (!this.state.mergeItems && i.group && this.state.collapsedGroups.includes(i.group));
                    let isSubSection = (i.group && i.group.match(/^\d+\.\d+/)); 
                    const dashStyle = "1px dashed rgba(0, 0, 0, 0.2)"; 
                    if (!this.state.mergeItems && i.group && i.group !== lastGroup) {
                        let icon = ""; if (i.group.includes("–ì–∞–∑–æ–≤–æ–≥–æ")) icon = "üî•"; else if (i.group.includes("–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ")) icon = "‚ö°"; else if (i.group.includes("–í–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è")) icon = "üíß";
                        let arrow = isCollapsed ? "‚ñ∂" : "‚§µ";
                        let txtUnit = isCollapsed ? "–∫–æ–º–ø–ª." : ""; let txtQty = isCollapsed ? "1" : ""; let txtSum = isCollapsed ? groupTotals[i.group].toLocaleString() : "";
                        let headStyle = "";
                        if (isSubSection) { headStyle = `style="background:#fff; border: ${dashStyle}; border-bottom: none; color:#000;"`; if (isCollapsed) headStyle = `style="background:#fff; border: ${dashStyle}; color:#000;"`; }
                        let titleColSpan = showSku ? 5 : 4;
                        rows += `<tr class="group-header" ${headStyle} onclick="app.toggleGroup('${i.group}')" title="–°–≤–µ—Ä–Ω—É—Ç—å/–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å"><td colspan="${titleColSpan}" style="text-align:left; padding-left:10px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"><b>${arrow} ${icon} ${i.group}</b></td><td class="col-unit" style="color:#9CA3AF; font-size:10px;">${txtUnit}</td><td class="col-qty" style="font-weight:700;">${txtQty}</td><td class="col-price"></td><td class="col-sum">${txtSum}</td></tr>`;
                        lastGroup = i.group;
                    }
                    let rowStyle = "";
                    if (isCollapsed) { rowStyle = 'style="display:none;"'; } 
                    else if (!this.state.mergeItems && isSubSection) { let borders = `border-left: ${dashStyle}; border-right: ${dashStyle};`; let nextItem = bill[arrIndex + 1]; if (!nextItem || nextItem.group !== i.group) borders += ` border-bottom: ${dashStyle};`; else borders += " border-bottom: 1px solid #f9fafb;"; rowStyle = `style="background:#fff; ${borders}"`; }
                    else if (!this.state.mergeItems && i.group) { if (i.group.includes("–ì–∞–∑–æ–≤–æ–≥–æ") || i.group.includes("–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ")) rowStyle = 'style="background-color: rgba(243, 244, 246, 0.5);"'; }
                    let tipHtml = i.qtyTip ? `<div class="tooltip-wrapper"><div class="info-icon">i</div><div class="tooltip-content">${i.qtyTip}</div></div>` : "";
                    let qHtml = `<div class="qty-wrap">${i.q}${tipHtml}</div>`;
                    let imgContent = getImg(i);
                    let lookupId = i.originalId || i.id;
                    let hasAlts = (i.alts && i.alts.length > 0) || this.state.swaps[lookupId];
                    let imgCellHtml = "";
                    if (hasAlts) {
                        let isOpen = (this.state.showSwapFor === lookupId);
                        let wrapClass = isOpen ? "img-wrap show-swap-ui" : "img-wrap";
                        let svgIcon = `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"></path><path d="M16 21h5v-5"></path></svg>`;
                        imgCellHtml = `<td class="col-img swappable-cursor"><div class="${wrapClass}" onclick="app.toggleSwapUI('${lookupId}')" title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–º–µ–Ω–∏—Ç—å"><div class="swap-cycle-btn" onclick="event.stopPropagation(); app.cycleSwap('${lookupId}')">${svgIcon}</div>${imgContent}</div></td>`;
                    } else { imgCellHtml = `<td class="col-img">${imgContent}</td>`; }
                    rows += `<tr ${rowStyle}><td class="col-idx">${globalIdx++}</td>${imgCellHtml}<td class="col-name">${i.name}</td><td class="col-sku ${showSku?'':'hidden-col'}">${i.displaySku}</td><td class="col-brand">${i.brand||'STOUT'}</td><td class="col-unit">${i.unit||'—à—Ç'}</td><td class="col-qty">${qHtml}</td><td class="col-price">${i.price.toLocaleString()}</td><td class="col-sum">${i.sum.toLocaleString()}</td></tr>`;
                });
                h += rows + `<tr class="row-subtotal"><td colspan="9">–ò—Ç–æ–≥–æ: ${secTotal.toLocaleString()} ‚ÇΩ</td></tr>`;
                sum += secTotal; bill = []; 
            };

            // === 1. –ö–û–¢–Å–õ + –í–û–î–û–ù–ê–ì–†–ï–í–ê–¢–ï–õ–¨ ===
            let selBoilers = [], boilerCnt = 0;
            ['gas','el'].forEach(ft => {
                if(this.state.fuels.includes(ft)) {
                    let needed = parseFloat(pwr);
                    let db = (ft === 'gas') ? catalog.boilers_gas : (this.state.boilerSeries === 'status' ? catalog.boilers_status : catalog.boilers_plus);
                    let b = db.find(x => x.power >= needed);
                    if(ft==='el') {
                        if(!b && needed > 27) { let half = needed/2; let b2 = db.find(x => x.power >= half); if(b2) { b2.alts = (this.state.boilerSeries === 'status') ? catalog.boilers_plus : catalog.boilers_status; addToBill(b2, 2, this.getDesc('boiler_el', needed)); selBoilers.push(b2,b2); } } 
                        else { let t = b || db[db.length-1]; t.alts = (this.state.boilerSeries === 'status') ? catalog.boilers_plus : catalog.boilers_status; addToBill(t, 1, this.getDesc('boiler_el', needed)); selBoilers.push(t); }
                    } else if (ft==='gas') {
                        let t = (needed > 31) ? db.find(x=>x.id==="100022963") : (b || db.find(x=>x.id==="100022963"));
                        let q = (needed > 31) ? 2 : 1; addToBill(t, q, this.getDesc('boiler_gas', needed)); for(let k=0;k<q;k++) selBoilers.push(t);
                    }
                }
            });
            boilerCnt = selBoilers.length;
            if(this.state.hotWater) { 
                let vol = this.state.res>=7?300 : this.state.res>=5?200 : this.state.res>=3?150 : 100; 
                let tankDb = (this.state.boilerType === 'optibase') ? catalog.tanks_optibase : catalog.tanks_standard;
                let t = tankDb.find(x=>x.vol===vol) || tankDb[tankDb.length-1]; 
                t.alts = [catalog.tanks_optibase[0], catalog.tanks_standard[0]]; 
                addToBill(t, 1, this.getDesc('boiler_tank', this.state.res, vol)); 
            }
            flushBill("1. –ö–æ—Ç—ë–ª + –≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å");

            // === 2. –û–ë–í–Ø–ó–ö–ê –ö–û–¢–ï–õ–¨–ù–û–ô ===
            selBoilers.forEach(b => { 
                if(b.type === 'gas') { 
                    let grp = "2.1. –û–±–≤—è–∑–∫–∞ –ì–∞–∑–æ–≤–æ–≥–æ –∫–æ—Ç–ª–∞"; 
                    addToBill(catalog.chimneys[0], 1, this.getDesc('chimney'), grp); 
                    addToBill(catalog.stabs[0], 1, this.getDesc('stab'), grp); 
                    addToBill(catalog.american_34, 2, "–†–∞–∑—ä–µ–º–Ω–æ–µ —Å–æ–µ–¥.", grp); 
                    addToBill(catalog.ball_valve_34, 2, "–ó–∞–ø–æ—Ä–Ω–∞—è –∞—Ä–º–∞—Ç—É—Ä–∞.", grp); 
                    addToBill(catalog.filter_mag, 1, "–ó–∞—â–∏—Ç–∞ –æ—Ç —à–ª–∞–º–∞.", grp); 
                    if(this.state.hotWater) { addToBill(catalog.valves[0], 1, this.getDesc('fugas'), grp); addToBill(catalog.nipple_34, 2, "–î–ª—è —Ñ—É–≥–∞—Å–∞.", grp); }
                    if (selBoilers.length > 1) addToBill(catalog.check_valve_34, 1, "–û–±—Ä–∞—Ç–Ω—ã–π –∫–ª–∞–ø–∞–Ω.", grp); 
                } 
            });
            selBoilers.forEach(b => { 
                if(b.type !== 'gas') { 
                    let grp = "2.2. –û–±–≤—è–∑–∫–∞ –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –∫–æ—Ç–ª–∞"; 
                    let s = b.power<=18 ? catalog.stabs[1] : catalog.stabs[2]; addToBill(s, 1, this.getDesc('stab'), grp); 
                    addToBill(catalog.american_34, 2, "–†–∞–∑—ä–µ–º–Ω–æ–µ —Å–æ–µ–¥.", grp); 
                    addToBill(catalog.ball_valve_34, 2, "–ó–∞–ø–æ—Ä–Ω–∞—è –∞—Ä–º–∞—Ç—É—Ä–∞.", grp); 
                    addToBill(catalog.filter_mag, 1, "–ó–∞—â–∏—Ç–∞ –æ—Ç —à–ª–∞–º–∞.", grp); 
                    if(this.state.hotWater) { addToBill(catalog.valves[0], 1, this.getDesc('fugas'), grp); addToBill(catalog.nipple_34, 2, "–î–ª—è —Ñ—É–≥–∞—Å–∞.", grp); }
                    if (selBoilers.length > 1) addToBill(catalog.check_valve_34, 1, "–û–±—Ä–∞—Ç–Ω—ã–π –∫–ª–∞–ø–∞–Ω.", grp); 
                } 
            });
            if(this.state.hotWater) { 
                let grp = "2.3. –û–±–≤—è–∑–∫–∞ –í–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è"; 
                let vol = this.state.res>=7?300 : this.state.res>=5?200 : this.state.res>=3?150 : 100; 
                let exp = catalog.exp_dhw.find(x => x.vol >= vol*0.1) || catalog.exp_dhw[2]; 
                addToBill(exp, 1, this.getDesc('exp_d', vol, exp.vol), grp); 
                addToBill(catalog.tank_mount, 1, "–ö—Ä–µ–ø–ª–µ–Ω–∏–µ", grp); addToBill(catalog.tank_kit, 1, "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∞–∫–∞", grp); 
                addToBill(catalog.dhw_fittings[0], 2, "–ê–º–µ—Ä–∏–∫–∞–Ω–∫–∞ 1\" (–ó–º–µ–µ–≤–∏–∫)", grp); addToBill(catalog.dhw_fittings[1], 2, "–ö—Ä–∞–Ω 1\" (–ó–º–µ–µ–≤–∏–∫)", grp);
                addToBill(catalog.dhw_fittings[2], 1, "–ê–º–µ—Ä–∏–∫–∞–Ω–∫–∞ 3/4\" (–ì–í–°)", grp); addToBill(catalog.dhw_fittings[3], 1, "–ö—Ä–∞–Ω 3/4\" (–ì–í–°)", grp);
                addToBill(catalog.dhw_fittings[4], 1, "–ö–ª–∞–ø–∞–Ω 6 –±–∞—Ä", grp); addToBill(catalog.dhw_fittings[5], 1, "–ö—Ä–µ—Å—Ç–æ–≤–∏–Ω–∞ 3/4\"", grp); addToBill(catalog.dhw_fittings[6], 1, "–ö–ª–∞–ø–∞–Ω –æ–±—Ä–∞—Ç–Ω—ã–π (–•–í–°)", grp); addToBill(catalog.dhw_fittings[7], 1, "–ö—Ä–∞–Ω 3/4\" (–•–í–°)", grp);
                if (this.state.recirc) { addToBill(catalog.dhw_pump[0], 1, "–ù–∞—Å–æ—Å –ì–í–°", grp); addToBill(catalog.dhw_fittings[2], 1, "–ê–º–µ—Ä–∏–∫–∞–Ω–∫–∞ 3/4\" (–†–µ—Ü–∏—Ä–∫.)", grp); addToBill(catalog.dhw_fittings[3], 1, "–ö—Ä–∞–Ω 3/4\" (–†–µ—Ü–∏—Ä–∫.)", grp); addToBill(catalog.dhw_fittings[6], 1, "–û–±—Ä–∞—Ç–Ω—ã–π –∫–ª–∞–ø–∞–Ω (–†–µ—Ü–∏—Ä–∫.)", grp); }
            }
            let hasRad = this.state.systems.includes('rad');
            let hasTp = this.state.systems.includes('tp');
            let radSecs = 0, radMeters = 0, tpMeters = 0;
            let tpArea = this.state.tp1 + this.state.tp2;
            if(hasRad) { let load = (hasTp && tpArea>0) ? pwr*1000*0.7 : pwr*1000; radSecs = Math.ceil(load/117); if(radSecs>0) { let pipe = Math.ceil(this.state.win * (Math.sqrt(this.state.area/(this.state.floors===2?2:1))+3) * 1.1); radMeters = pipe*2; } }
            tpMeters = hasTp ? tpArea*7 : 0;
            let useEco = (!hasRad && hasTp && tpArea<=120);
            let needGroup = true;
            if (!hasTp && this.state.area<=150 && pwr<=20 && this.state.floors===1) needGroup = false;
            if (hasRad && this.state.floors===2) needGroup = true;
            let grpCnt = 0; if(!useEco && (needGroup||hasTp)) grpCnt=1;
            let boilersVol = 0; if (selBoilers.length > 0) { selBoilers.forEach(b => { boilersVol += (b.vol !== undefined ? b.vol : 6); }); }
            let vSys = (boilersVol + radSecs*0.25 + radMeters*0.11 + tpMeters*0.113 + grpCnt*5) * 1.15;
            let reqExp = vSys * 0.12; let bltin = 0; if (selBoilers.length > 0) { selBoilers.forEach(b => { bltin += (b.exp !== undefined ? b.exp : 0); }); }
            let def = reqExp - bltin; if(def>0) { let et = catalog.exp_heating.find(t=>t.vol>=def) || catalog.exp_heating[4]; addToBill(et, 1, this.getDesc('exp_h', Math.round(vSys))); if(et.vol<=25) addToBill(catalog.tank_mount, 1, "–ö—Ä–µ–ø–ª–µ–Ω–∏–µ –±–∞–∫–∞."); addToBill(catalog.tank_kit, 1, "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∞–∫–∞."); }
            
            if(!useEco) { 
                let big = (pwr>30 || tpArea>120); let dn25 = big; let hyd = null, rQ = 0, tQ = 0, pmp = null; 
                if(hasRad && needGroup) { rQ = (this.state.floors===2)?2:1; } 
                if(hasTp) tQ=1; 
                if(needGroup || hasTp) { 
                    let circuits = rQ + tQ; let idx = (circuits > 2) ? 1 : 0; 
                    if (dn25) { let item = catalog.hydro_dn25[idx]; addToBill(item, 1, "–ì–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–≤—è–∑–∫–∞ (DN25)."); } 
                    else { if (this.state.hydroType === 'combo') { let item = catalog.hydro_dn20[idx]; item.alts = catalog.hydro_modular_dn20; addToBill(item, 1, "–ö–æ–ª–ª–µ–∫—Ç–æ—Ä-–≥–∏–¥—Ä–æ—Å—Ç—Ä–µ–ª–∫–∞ (–ö–æ–º–±–∏)."); } else { let item = catalog.hydro_modular_dn20[idx]; item.alts = catalog.hydro_dn20; addToBill(item, 1, "–†–∞—Å–ø—Ä. –∫–æ–ª–ª–µ–∫—Ç–æ—Ä."); addToBill(catalog.hydro_arrow, 1, "–ì–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–µ–ª–∫–∞."); } }
                } 
                let grps = dn25 ? catalog.groups_dn25 : catalog.groups_dn20;
                if (dn25) { let activePump = catalog.pumps_dn25.find(p => p.type === this.state.pumpType) || catalog.pumps_dn25[0]; activePump.alts = catalog.pumps_dn25; pmp = activePump; } else { pmp = catalog.pumps_dn20[0]; }
                if(hyd) addToBill(hyd, 1, "–ì–∏–¥—Ä–æ—Å—Ç—Ä–µ–ª–∫–∞.");
                if(rQ>0) addToBill(grps[0], rQ, "–ì—Ä—É–ø–ø–∞ –ø—Ä—è–º–∞—è (–†–∞–¥–∏–∞—Ç–æ—Ä—ã).");
                if(tQ>0) addToBill(grps[1], tQ, "–ì—Ä—É–ø–ø–∞ —Å–º–µ—Å–∏—Ç–µ–ª—å–Ω–∞—è (–¢–ü).");
                if(rQ+tQ>0) addToBill(pmp, rQ+tQ, this.getDesc('pump_std')); 
            }
            flushBill("2. –û–±–≤—è–∑–∫–∞ –∫–æ—Ç–µ–ª—å–Ω–æ–π");

            if(hasRad && radSecs>0) {
                let win = this.state.win; let heatLoad = Math.round((hasTp&&tpArea>0)?pwr*700:pwr*1000); let loadPerWindow = heatLoad / win;
                let totalSecSpace = Math.ceil(heatLoad / 117); let countSpace = Math.max(win, Math.ceil(totalSecSpace / 14)); let secPerRadSpace = Math.max(4, Math.min(14, Math.ceil(totalSecSpace / countSpace))); let itemSpace = catalog.rads.find(x=>x.sec===secPerRadSpace) || catalog.rads[catalog.rads.length-1];
                let totalSecTitan = Math.ceil(heatLoad / 128); let countTitan = Math.max(win, Math.ceil(totalSecTitan / 14)); let secPerRadTitan = Math.max(4, Math.min(14, Math.ceil(totalSecTitan / countTitan))); let itemTitan = titanRads.find(x=>x.sec===secPerRadTitan);
                let bestPanel = steelRads.find(s => s.power50 >= loadPerWindow); let countSteel = win; if (!bestPanel) { let maxPanel = steelRads[steelRads.length-1]; countSteel = Math.max(win, Math.ceil(heatLoad / maxPanel.power50)); bestPanel = maxPanel; } let itemSteel = bestPanel;
                let altsList = [itemSpace, itemTitan, itemSteel]; itemSpace.alts = altsList; itemTitan.alts = altsList; itemSteel.alts = altsList;
                let activeItem = itemSpace; let activeCount = countSpace;
                if (this.state.radType === 'titan') { activeItem = itemTitan; activeCount = countTitan; } else if (this.state.radType === 'steel') { activeItem = itemSteel; activeCount = countSteel; }
                let unitPower = activeItem.isPanel ? activeItem.power50 : (activeItem.power50 * activeItem.sec); let totalSysPower = unitPower * activeCount;
                let desc = `<b>–í—ã–±—Ä–∞–Ω: ${activeItem.name}</b><br>–ú–æ—â–Ω–æ—Å—Ç—å: <b>${totalSysPower} –í—Ç</b> (${activeCount} —à—Ç). –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å: ${heatLoad} –í—Ç.`;
                addToBill(activeItem, activeCount, this.getDesc('rad_item', heatLoad));
                let grp = "3.1. –û–±–≤—è–∑–∫–∞ —Ä–∞–¥–∏–∞—Ç–æ—Ä–æ–≤"; 
                let activeHead = catalog.heads.find(h => h.type === this.state.headType) || catalog.heads[0]; activeHead.alts = catalog.heads; addToBill(activeHead, activeCount, this.getDesc('rad_head'), grp); 
                if (activeHead.type === 'smart') { let radHubs = Math.ceil(activeCount / 15); addToBill(catalog.smart_hub, radHubs, `–®–ª—é–∑ Zigbee.`, grp); }
                let activeHValve = catalog.h_valves.find(v => v.type === this.state.connectionType) || catalog.h_valves[0]; activeHValve.alts = catalog.h_valves; addToBill(activeHValve, activeCount, this.getDesc('rad_valves'), grp);
                if (activeItem.isPanel) { addToBill(catalog.rad_kits[0], activeCount*2, "–ù–∏–ø–ø–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–π.", grp); }
                if (activeHValve.id === 'SVH-0002-000020') { addToBill(catalog.rad_tube_set[0], activeCount * 2, "–¢—Ä—É–±–∫–∞ –ì-–æ–±—Ä–∞–∑–Ω–∞—è.", grp); addToBill(catalog.rad_tube_set[1], activeCount, "–°–∫–æ–±–∞ —Ñ–∏–∫—Å–∞—Ç–æ—Ä.", grp); addToBill(catalog.rad_tube_set[2], activeCount * 2, "–ì–∏–ª—å–∑–∞ 16.", grp); addToBill(catalog.rad_tube_set[3], activeCount * 2, "–§–∏—Ç–∏–Ω–≥ –∫–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π.", grp); }
                let floorArea = this.state.area / (this.state.floors===2 ? 2 : 1); let avgRun = Math.sqrt(floorArea) + 3; let totalMeters = activeCount * avgRun * 1.1; let neededPipe = Math.ceil(totalMeters);
                if (neededPipe > 0) {
                    if (this.state.pipeType === 'insulated') {
                        let coils = Math.ceil(neededPipe / 100); let halfCoils = Math.ceil(coils / 2);
                        let itemRed = catalog.insulated_pipes[0]; itemRed.alts = catalog.rad_pipes_grey; addToBill(itemRed, halfCoils, `–¢—Ä—É–±–∞ –≤ –∫—Ä–∞—Å–Ω–æ–π –∏–∑–æ–ª.`, grp); 
                        let itemBlue = catalog.insulated_pipes[1]; itemBlue.alts = catalog.rad_pipes_grey; addToBill(itemBlue, halfCoils, `–¢—Ä—É–±–∞ –≤ —Å–∏–Ω–µ–π –∏–∑–æ–ª.`, grp); 
                    } else {
                        let grayItem = (neededPipe > 200) ? catalog.rad_pipes_grey[1] : catalog.rad_pipes_grey[0]; grayItem.alts = catalog.insulated_pipes; addToBill(grayItem, Math.ceil(neededPipe/grayItem.len), this.getDesc('rad_pipe', neededPipe), grp);
                        let insLen = Math.ceil(neededPipe / 2); if(insLen % 2 !== 0) insLen++; addToBill(catalog.insulation[0], insLen, "–ò–∑–æ–ª—è—Ü–∏—è –∫—Ä–∞—Å–Ω–∞—è.", grp); addToBill(catalog.insulation[1], insLen, "–ò–∑–æ–ª—è—Ü–∏—è —Å–∏–Ω—è—è.", grp);
                    }
                }
                let reqLoops = (this.state.floors===2 ? Math.ceil(activeCount/2) : activeCount); if (reqLoops > 12) reqLoops = 12; let manifoldsCount = (this.state.floors === 2) ? 2 : 1; 
                if (this.state.radManifoldType === 'standard') { let m = catalog.manifolds_rad.find(x => x.loops === reqLoops) || catalog.manifolds_rad[catalog.manifolds_rad.length - 1]; if (m) { m.alts = [catalog.manifolds_chrome_blocks[0]]; addToBill(m, manifoldsCount, this.getDesc('manifold', activeCount, 'rad'), grp); } } 
                else {
                    const assemblyMap = { 2: [0, 0, 1], 3: [0, 1, 0], 4: [1, 0, 0], 5: [0, 1, 1], 6: [0, 2, 0], 7: [1, 1, 0], 8: [2, 0, 0], 9: [1, 1, 1], 10: [1, 2, 0], 11: [2, 1, 0], 12: [3, 0, 0] }; let plan = assemblyMap[reqLoops] || [3,0,0]; let b4 = catalog.manifolds_chrome_blocks[2]; let b3 = catalog.manifolds_chrome_blocks[1]; let b2 = catalog.manifolds_chrome_blocks[0]; let stdAlt = catalog.manifolds_rad.find(x => x.loops === reqLoops) || catalog.manifolds_rad[0]; [b4, b3, b2].forEach(b => b.alts = [stdAlt]); let multiplier = manifoldsCount * 2;
                    if (plan[0] > 0) addToBill(b4, plan[0] * multiplier, `–ë–ª–æ–∫ 4 –≤—ã—Ö.`, grp); if (plan[1] > 0) addToBill(b3, plan[1] * multiplier, `–ë–ª–æ–∫ 3 –≤—ã—Ö.`, grp); if (plan[2] > 0) addToBill(b2, plan[2] * multiplier, `–ë–ª–æ–∫ 2 –≤—ã—Ö.`, grp); addToBill(catalog.manifold_brackets, manifoldsCount, "–ö—Ä–æ–Ω—à—Ç–µ–π–Ω—ã.", grp);
                }
                addToBill(catalog.parts[1], activeCount*2, "–ï–≤—Ä–æ–∫–æ–Ω—É—Å 16 (–†–∞–¥).", grp); addToBill(catalog.parts[2], activeCount*2, "–§–∏–∫—Å–∞—Ç–æ—Ä 90¬∞.", grp); addToBill(catalog.protective_sleeves[0], activeCount, "–í—Ç—É–ª–∫–∞ (–ø–æ–¥).", grp); addToBill(catalog.protective_sleeves[1], activeCount, "–í—Ç—É–ª–∫–∞ (–æ–±—Ä).", grp); addToBill(catalog.label_kits[0], 1, "–ù–∞–∫–ª–µ–π–∫–∏.", grp);
            }
            flushBill("3. –ü—Ä–∏–±–æ—Ä—ã –æ—Ç–æ–ø–ª–µ–Ω–∏—è");

            if(hasTp && tpMeters>0) {
                let q5 = Math.floor(tpMeters/500); let q1 = Math.ceil((tpMeters%500)/100); 
                if(q5) addToBill(catalog.pipes[1], q5, this.getDesc('ufh_pipe', tpMeters)); if(q1) addToBill(catalog.pipes[0], q1, this.getDesc('ufh_pipe', tpMeters));
                let loops = 0, mans = 0; 
                const proc = (a, lbl) => { 
                    if(a<=0) return; let l = Math.ceil((a*7)/85); if(l===1) l=2; loops+=l; let n = Math.ceil(l/12); 
                    for(let i=0; i<n; i++) { let sz = Math.floor(l/n) + (i<(l%n)?1:0); let m = catalog.manifolds.find(x=>x.loops===sz); if(m) { addToBill({...m, name:`–ö–æ–ª–ª–µ–∫—Ç–æ—Ä –¢–ü ${sz} –≤—ã—Ö (${lbl})`}, 1, this.getDesc('manifold', sz, 'ufh')); mans++; if(useEco) { addToBill(catalog.mixing_units[0],1, this.getDesc('ufh_mix')); addToBill(catalog.pumps_mix[0], 1, this.getDesc('pump_std')); } } } 
                }; 
                proc(this.state.tp1, "1 —ç—Ç–∞–∂"); proc(this.state.tp2, "2 —ç—Ç–∞–∂"); 
                addToBill(catalog.parts[0], mans*2, "–ö–æ–Ω—Ü–µ–≤—ã–µ —Ñ–∏—Ç–∏–Ω–≥–∏."); addToBill(catalog.parts[3], loops*2, "–ï–≤—Ä–æ–∫–æ–Ω—É—Å 16 (–¢–ü)."); addToBill(catalog.parts[2], loops*2, "–§–∏–∫—Å–∞—Ç–æ—Ä 90¬∞.");
                addToBill(catalog.protective_sleeves[0], loops, "–í—Ç—É–ª–∫–∞ –∫—Ä–∞—Å–Ω–∞—è."); addToBill(catalog.protective_sleeves[1], loops, "–í—Ç—É–ª–∫–∞ —Å–∏–Ω—è—è."); addToBill(catalog.label_kits[1], 1, "–ù–∞–∫–ª–µ–π–∫–∏.");
                let grpIns = "4.1. –£–¢–ï–ü–õ–ò–¢–ï–õ–¨ –ò –ö–†–ï–ü–Å–ñ";
                if (this.state.ufhBaseType === 'mat') { let mt = catalog.mats[0]; mt.alts = [catalog.xps_kit[0]]; let mc = Math.ceil((tpArea / mt.area) * 1.05); addToBill(mt, mc, this.getDesc('ufh_mat', tpArea), grpIns); } 
                else { let xpsItem = catalog.xps_kit[0]; xpsItem.alts = catalog.mats; let sheets = Math.ceil((tpArea / xpsItem.area) * 1.05); addToBill(xpsItem, sheets, this.getDesc('ufh_xps'), grpIns); let totalDowels = Math.ceil(tpArea * 5); addToBill(catalog.xps_kit[1], Math.ceil(totalDowels / 100), `–î—é–±–µ–ª—è.`, grpIns); let totalStaples = Math.ceil(tpMeters * 2.5); addToBill(catalog.xps_kit[2], Math.ceil(totalStaples / 25), `–°–∫–æ–±—ã.`, grpIns); let tapeRolls = Math.ceil((sheets * 1.76 * 1.1) / 50); addToBill(catalog.xps_kit[3], tapeRolls, `–°–∫–æ—Ç—á.`, grpIns); }
                
                if (this.state.ufhAuto) {
                    let grpAuto = "4.2. –ê–í–¢–û–ú–ê–¢–ò–ö–ê –¢–Å–ü–õ–û–ì–û –ü–û–õ–ê"; 
                    addToBill(catalog.actuators, loops, this.getDesc('actuator'), grpAuto);
                    let zones = this.state.ufhZones; 
                    let activeStatBase = (this.state.ufhCtrl === 'mech') ? catalog.ufh_mech[0] : catalog.ufh_electro[0]; 
                    addToBill(activeStatBase, zones, this.getDesc('thermostat'), grpAuto);
                    let cntByZones = Math.ceil(zones / 8); let cntByFloors = (this.state.floors === 2 && this.state.tp2 > 0) ? 2 : 1; 
                    let finalCnt = Math.max(cntByZones, cntByFloors);
                    addToBill(catalog.wiring_center, finalCnt, "–ö–æ–º–º—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫.", grpAuto);
                }
                
                let warn = null; if(!hasRad && tpArea>0) { let f = (pwr*1000)/tpArea; if(f>75) warn = `‚ö†Ô∏è –¢–ü –º–æ–∂–µ—Ç –Ω–µ —Ö–≤–∞—Ç–∏—Ç—å! –ù–∞–≥—Ä—É–∑–∫–∞: ${Math.round(f)} –í—Ç/–º¬≤.`; }
                flushBill("4. –í–æ–¥—è–Ω–æ–π —Ç—ë–ø–ª—ã–π –ø–æ–ª", warn);
            }

            if(this.state.water && this.state.waterZones.length > 0) {
                let mainTitle = "5. –í–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ";
                let isMerge = this.state.mergeItems;
                let grpCold = isMerge ? mainTitle : "5.1. –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –•–í–°";
                let grpHot = isMerge ? mainTitle : "5.2. –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –ì–í–°";
                let grpRecirc = isMerge ? mainTitle : "5.3. –†–µ—Ü–∏—Ä–∫—É–ª—è—Ü–∏—è";
                let grpGen = isMerge ? mainTitle : "5.4. –û–±—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã";
                let totalColdPoints = 0, totalHotPoints = 0, totalToilets = 0;
                let totalPipeCold = 0, totalPipeHot = 0;
                let recirc = this.state.recirc;

                this.state.waterZones.forEach(z => {
                    let f = z.fixtures;
                    totalToilets += f.toilet;
                    let cw_only = f.toilet + f.wash + f.dish;
                    let mix = f.basin + f.shower;
                    let zoneCold = cw_only + mix;
                    let zoneHot = mix;
                    totalColdPoints += zoneCold;
                    totalPipeCold += (z.dist * zoneCold * 1.1);
                    if (recirc) {
                        totalHotPoints++; 
                        if(zoneHot > 0) totalPipeHot += ((z.dist * 2) + (zoneHot * 2));
                    } else {
                        totalHotPoints += zoneHot; 
                        if(zoneHot > 0) totalPipeHot += (z.dist * zoneHot * 1.1);
                    }
                });

                // 5.1 –•–í–°
                if(totalColdPoints > 0) {
                    // 1. –¢—Ä—É–±–∞ –∏ –∏–∑–æ–ª—è—Ü–∏—è (–ù—É–∂–Ω—ã –≤—Å–µ–≥–¥–∞)
                    let pLen = Math.ceil(totalPipeCold);
                    addToBill(catalog.water_pipes[0], pLen, this.getDesc('pipe_cw', `${pLen} –º`), grpCold);
                    addToBill(catalog.water_insulation[1], pLen, this.getDesc('ins_blue', pLen), grpCold);

                    // 2. –ö–æ–ª–ª–µ–∫—Ç–æ—Ä–Ω—ã–π —É–∑–µ–ª (–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –±–æ–ª—å—à–µ 1 —Ç–æ—á–∫–∏)
                    if (totalColdPoints > 1) {
                        let needed = totalColdPoints, q4 = Math.floor(needed/4), rem = needed%4, q3=0, q2=0;
                        if(rem===3)q3=1; else if(rem===2)q2=1; else if(rem===1){if(q4>0){q4--;q3=1;q2=1}else{q2=1}}
                        
                        let descColl = this.getDesc('manifold', totalColdPoints, 'cw');
                        if(q4) addToBill(catalog.water_manifolds_cold[2], q4, descColl, grpCold);
                        if(q3) addToBill(catalog.water_manifolds_cold[1], q3, descColl, grpCold);
                        if(q2) addToBill(catalog.water_manifolds_cold[0], q2, descColl, grpCold);
                        
                        addToBill(catalog.water_parts[0], totalColdPoints, this.getDesc('eurocone_water', totalColdPoints), grpCold);
                        addToBill(catalog.water_parts[2], 1, "–ó–∞–≥–ª—É—à–∫–∞ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞", grpCold);
                    }

                    // 3. –í–æ–¥–æ—Ä–æ–∑–µ—Ç–∫–∏ (–ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏)
                    let socketsCold = totalColdPoints - totalToilets;
                    if(socketsCold > 0) {
                        addToBill(catalog.water_fittings[0], socketsCold, this.getDesc('socket', '–¢—É–ø–∏–∫–æ–≤–∞—è (–•–í–°)', socketsCold), grpCold);
                        addToBill(catalog.water_parts[7], socketsCold, this.getDesc('sleeve', '1 —à—Ç –Ω–∞ —Ä–æ–∑–µ—Ç–∫—É'), grpCold);
                        addToBill(catalog.water_fittings[4], socketsCold, "–ü—Ä–æ–±–∫–∞ —Å–∏–Ω—è—è (–æ–ø—Ä–µ—Å—Å–æ–≤–∫–∞)", grpCold); 
                        addToBill(catalog.water_fittings[6], socketsCold, "–§–∏–∫—Å–∞—Ç–æ—Ä 90¬∞", grpCold);
                    }
                    // –£–Ω–∏—Ç–∞–∑—ã (–ò–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏)
                    if(totalToilets > 0) addToBill(catalog.water_fittings[8], totalToilets, "–§–∏–∫—Å–∞—Ç–æ—Ä —Ç—Ä—É–±—ã (–∫ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏)", grpCold);
                }

                // 5.2 –ì–í–°
                if(totalPipeHot > 0) {
                    // 1. –¢—Ä—É–±–∞ –∏ –∏–∑–æ–ª—è—Ü–∏—è
                    let pLen = Math.ceil(recirc ? (totalPipeHot / 2) : totalPipeHot); 
                    addToBill(catalog.water_pipes[0], pLen, this.getDesc('pipe_hw', `${pLen} –º`), grpHot);
                    addToBill(catalog.water_insulation[0], pLen, this.getDesc('ins_red', pLen), grpHot);

                    // 2. –ö–æ–ª–ª–µ–∫—Ç–æ—Ä–Ω—ã–π —É–∑–µ–ª (–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –±–æ–ª—å—à–µ 1 —Ç–æ—á–∫–∏)
                    if (totalHotPoints > 1) {
                        let needed = totalHotPoints, q4 = Math.floor(needed/4), rem = needed%4, q3=0, q2=0;
                        if(rem===3)q3=1; else if(rem===2)q2=1; else if(rem===1){if(q4>0){q4--;q3=1;q2=1}else{q2=1}}
                        let descColl = this.getDesc('manifold', totalHotPoints, recirc ? 'hw_recirc' : 'hw_std');

                        if(q4) addToBill(catalog.water_manifolds_hot[2], q4, descColl, grpHot);
                        if(q3) addToBill(catalog.water_manifolds_hot[1], q3, descColl, grpHot);
                        if(q2) addToBill(catalog.water_manifolds_hot[0], q2, descColl, grpHot);

                        addToBill(catalog.water_parts[0], totalHotPoints, this.getDesc('eurocone_water', totalHotPoints), grpHot);
                        addToBill(catalog.water_parts[2], 1, "–ó–∞–≥–ª—É—à–∫–∞ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞", grpHot);
                    }

                    // 3. –í–æ–¥–æ—Ä–æ–∑–µ—Ç–∫–∏
                    let totalMixers = 0;
                    this.state.waterZones.forEach(z => totalMixers += (z.fixtures.basin + z.fixtures.shower));
                    
                    if(totalMixers > 0) {
                        let socketItem = recirc ? catalog.water_fittings[1] : catalog.water_fittings[0]; 
                        let sName = recirc ? "–£–≥–æ–ª—å–Ω–∏–∫ –ø—Ä–æ—Ç–æ—á–Ω—ã–π (–ë—Ä–æ–Ω–∑–∞)" : "–í–æ–¥–æ—Ä–æ–∑–µ—Ç–∫–∞ —Ç—É–ø–∏–∫–æ–≤–∞—è";
                        let sCount = recirc ? 2 : 1; 

                        addToBill(socketItem, totalMixers, this.getDesc('socket', sName, totalMixers), grpHot);
                        addToBill(catalog.water_parts[7], totalMixers * sCount, this.getDesc('sleeve', `${sCount} —à—Ç –Ω–∞ —Ä–æ–∑–µ—Ç–∫—É`), grpHot);
                        addToBill(catalog.water_fittings[5], totalMixers, "–ü—Ä–æ–±–∫–∞ –∫—Ä–∞—Å–Ω–∞—è (–æ–ø—Ä–µ—Å—Å–æ–≤–∫–∞)", grpHot);
                        
                        let fixCount = recirc ? totalMixers * 2 : totalMixers;
                        addToBill(catalog.water_fittings[6], fixCount, "–§–∏–∫—Å–∞—Ç–æ—Ä 90¬∞", grpHot);
                    }
                }

                if(recirc && totalHotPoints > 0) {
                    let needed = totalHotPoints, q4 = Math.floor(needed/4), rem = needed%4, q3=0, q2=0;
                    if(rem===3)q3=1; else if(rem===2)q2=1; else if(rem===1){if(q4>0){q4--;q3=1;q2=1}else{q2=1}}
                    let descColl = this.getDesc('manifold', totalHotPoints, 'recirc');
                    if(q4) addToBill(catalog.water_manifolds_recirc[2], q4, descColl, grpRecirc);
                    if(q3) addToBill(catalog.water_manifolds_recirc[1], q3, descColl, grpRecirc);
                    if(q2) addToBill(catalog.water_manifolds_recirc[0], q2, descColl, grpRecirc);
                    addToBill(catalog.water_parts[0], totalHotPoints, this.getDesc('eurocone_water', totalHotPoints), grpRecirc);
                    addToBill(catalog.water_parts[2], 1, "–ó–∞–≥–ª—É—à–∫–∞ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞", grpRecirc);
                    let pLen = Math.ceil(totalPipeHot / 2);
                    addToBill(catalog.water_pipes[0], pLen, this.getDesc('pipe_hw', `${pLen} –º (–û–±—Ä–∞—Ç–∫–∞)`), grpRecirc);
                    addToBill(catalog.water_insulation[0], pLen, this.getDesc('ins_red', pLen), grpRecirc);
                }

                let collGroups = (totalColdPoints>0?1:0) + (totalHotPoints>0?1:0) + (recirc?1:0);
                if(collGroups > 0) addToBill(catalog.manifold_brackets, collGroups, "–ü–∞—Ä–∞ –∫—Ä–æ–Ω—à—Ç–µ–π–Ω–æ–≤ –Ω–∞ –∫–∞–∂–¥—ã–π –∫–æ–ª–ª–µ–∫—Ç–æ—Ä", grpGen);
                addToBill(catalog.water_parts[3], 1, "–ù–∞–∫–ª–µ–π–∫–∏", grpGen);
                let totalBrackets = 0;
                this.state.waterZones.forEach(z => { totalBrackets += (z.fixtures.basin + z.fixtures.shower + z.fixtures.wash); });
                if(totalBrackets > 0) addToBill(catalog.water_fittings[3], totalBrackets, "–ú–æ–Ω—Ç–∞–∂–Ω–∞—è –ø–ª–∞–Ω–∫–∞ (–î–ª—è —Å–º–µ—Å–∏—Ç–µ–ª–µ–π)", grpGen);
                let allPipe = totalPipeCold + totalPipeHot;
                if(allPipe > 0) addToBill(catalog.water_fittings[8], Math.ceil(allPipe * 2), "–î—é–±–µ–ª—å-–∫—Ä—é–∫ –¥–≤–æ–π–Ω–æ–π", grpGen);

                if(isMerge) {
                    flushBill(mainTitle);
                } else {
                    flushBill(grpCold);
                    flushBill(grpHot);
                    flushBill(grpRecirc);
                    flushBill(grpGen);
                }

                if (totalToilets > 0) {
                    addToBill(catalog.water_parts[6], totalToilets, this.getDesc('install'), "6. –ö–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è");
                    flushBill("6. –ö–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è");
                }
            }

            // === 7. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´ ===
            let cl = catalog.coolants.find(c=>c.type===this.state.coolant); 
            if(cl) { 
                if(cl.type==='pro65') { 
                    let vP=vSys*0.65; let vH=vSys*0.35; let p1=catalog.coolants[2]; let p2=catalog.coolants[0]; 
                    addToBill(p1, Math.ceil(vP/p1.vol), "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç.", "7. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã"); addToBill(p2, Math.ceil(vH/p2.vol), "–í–æ–¥–∞.", "7. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã"); 
                } else { 
                    addToBill(cl, Math.ceil(vSys/cl.vol), this.getDesc('coolant', Math.round(vSys)), "7. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã"); 
                } 
            }
            flushBill("7. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã");

            document.getElementById('tbody').innerHTML = h;
            document.getElementById('total_sum').innerText = sum.toLocaleString() + " ‚ÇΩ";
            let d = showSku?'table-cell':'none'; document.querySelectorAll('.col-sku').forEach(e=>e.style.display=d); document.querySelector('.col-sku-head').style.display=d;
            this.saveState();
        },
    };
    window.onload = function() { app.init(); };
    </script>
</head>
<body>
<div class="container">
    <div class="panel input-panel">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h2 style="margin:0;">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h2>
            <div style="display:flex; gap:5px;">
                <button onclick="app.reset()" title="–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∏ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ" style="border:1px solid #FECACA; background:#FEF2F2; padding:6px; border-radius:8px; cursor:pointer; color:#EF4444; display:flex; align-items:center; justify-content:center; transition:0.2s;" onmouseover="this.style.background='#FEE2E2'" onmouseout="this.style.background='#FEF2F2'">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg>
                </button>
                
                <button onclick="app.loadFromCode()" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–¥" style="border:1px solid #E5E7EB; background:#fff; padding:6px 12px; border-radius:8px; cursor:pointer; font-size:11px; font-weight:600; color:#6B7280; display:flex; align-items:center; gap:5px; transition:0.2s;" onmouseover="this.style.borderColor='#2563EB';this.style.color='#2563EB'" onmouseout="this.style.borderColor='#E5E7EB';this.style.color='#6B7280'">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                    –ö–æ–¥
                </button>
            </div>
        </div>
        
        <div class="control-item"><div class="label-row"><span class="lbl">–ü–ª–æ—â–∞–¥—å</span><span class="val"><span id="val_area">150</span> –º¬≤</span></div><input type="range" id="inp_area" min="50" max="300" step="10" value="150" oninput="app.setArea(this.value)"></div>
        <div class="grid-2"><div class="control-card"><span class="lbl">–û–∫–Ω–∞</span><div class="stepper"><button class="step-btn" onclick="app.updWin(-1)">‚àí</button><div class="step-val" id="val_win">4</div><button class="step-btn" onclick="app.updWin(1)">+</button></div></div><div class="control-card"><span class="lbl">–í—Ç–æ—Ä–æ–π —ç—Ç–∞–∂</span><label class="switch"><input type="checkbox" id="chk_floors" onchange="app.toggleFloors(this.checked)"><span class="slider"></span></label></div></div>
        
        <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–º–∞</h3>
        <div class="control-item"><span class="lbl-sub">–†–µ–≥–∏–æ–Ω —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞</span><div class="tabs" id="reg_tabs"><div class="tab active" onclick="app.setRegion(130)">–°–∏–±–∏—Ä—å</div><div class="tab" onclick="app.setRegion(120)">–£—Ä–∞–ª</div><div class="tab" onclick="app.setRegion(100)">–¶–µ–Ω—Ç—Ä</div><div class="tab" onclick="app.setRegion(60)">–Æ–≥</div></div><div class="info-card" id="desc_reg"><span>üìç</span> –ó–∏–º–∞ –¥–æ -35¬∞C</div></div>
        <div class="control-item"><span class="lbl-sub">–ú–∞—Ç–µ—Ä–∏–∞–ª —Å—Ç–µ–Ω</span><div class="tabs" id="mat_tabs"><div class="tab" onclick="app.setMat(1.3)">–•–æ–ª–æ–¥–Ω—ã–π</div><div class="tab active" onclick="app.setMat(1.0)">–°—Ç–∞–Ω–¥–∞—Ä—Ç</div><div class="tab" onclick="app.setMat(0.8)">–¢—ë–ø–ª—ã–π</div></div><div class="info-card" id="desc_mat"><span>üß±</span> –ö–∏—Ä–ø–∏—á + –£—Ç–µ–ø–ª–∏—Ç–µ–ª—å</div></div>
        
        <h3>–°–∏—Å—Ç–µ–º–∞</h3>
        <div class="control-item"><div class="tabs"><div class="tab multi-active" id="fuel_el" onclick="app.toggleFuel('el')">–≠–ª–µ–∫—Ç—Ä–æ</div><div class="tab" id="fuel_gas" onclick="app.toggleFuel('gas')">–ì–∞–∑</div></div></div>
        
        <div class="control-item"><span class="lbl-sub">–¢–µ–ø–ª–æ–Ω–æ—Å–∏—Ç–µ–ª—å</span><div class="tabs"><div class="tab cool-tab active" data-type="water" onclick="app.setCoolant('water')">üíß –í–æ–¥–∞</div><div class="tab cool-tab" data-type="eco30" onclick="app.setCoolant('eco30')">‚ùÑÔ∏è -30¬∞C</div><div class="tab cool-tab" data-type="pro65" onclick="app.setCoolant('pro65')">‚ùÑÔ∏è -40¬∞C</div></div></div>

        <div class="control-item"><div class="tabs"><div class="tab multi-active" id="sys_rad" onclick="app.toggleSys('rad')">–†–∞–¥–∏–∞—Ç–æ—Ä—ã</div><div class="tab" id="sys_tp" onclick="app.toggleSys('tp')">–¢—ë–ø–ª—ã–π –ø–æ–ª</div></div></div>
        <div id="blk_tp_sliders" style="display:none; border-top:1px dashed #E5E7EB; padding-top:15px;"><div class="control-item"><div class="label-row"><span class="lbl">–¢—ë–ø–ª—ã–π –ø–æ–ª 1 —ç—Ç–∞–∂</span><span class="val"><span id="val_tp1">0</span> –º¬≤</span></div><input type="range" id="inp_tp1" min="0" max="150" value="0" oninput="app.updTp(1,this.value)"></div><div id="div_tp2" class="control-item" style="display:none;"><div class="label-row"><span class="lbl">–¢—ë–ø–ª—ã–π –ø–æ–ª 2 —ç—Ç–∞–∂</span><span class="val"><span id="val_tp2">0</span> –º¬≤</span></div><input type="range" id="inp_tp2" min="0" max="150" value="0" oninput="app.updTp(2,this.value)"></div></div>
        
        <div id="blk_ufh_ctrl" style="display:none; border-top:1px dashed #E5E7EB; padding-top:15px; margin-top:0;">
            <div class="control-item">
                <div class="label-row">
                    <span class="lbl">–ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞ –¢—ë–ø–ª–æ–≥–æ –ø–æ–ª–∞</span>
                    <label class="switch">
                        <input type="checkbox" id="chk_ufh_auto" onchange="app.toggleUfhAuto(this.checked)">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div id="blk_ufh_settings" style="display:none;">
                <div class="control-item">
                    <div class="control-card" style="width:100%; display:flex; flex-direction:row; justify-content:space-between; padding:15px; align-items:center;">
                        <span class="lbl" style="margin-right:15px;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–æ–≤</span>
                        <div class="stepper">
                            <button class="step-btn" onclick="app.updZones(-1)">‚àí</button>
                            <div class="step-val" id="val_zones">1</div>
                            <button class="step-btn" onclick="app.updZones(1)">+</button>
                        </div>
                    </div>
                </div>
                <div class="control-item">
                    <div class="label-row"><span class="lbl">–¢–∏–ø —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∞:</span></div>
                    <div class="tabs">
                        <div class="tab ufh-tab active" data-type="mech" onclick="app.setUfhCtrl('mech')">–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π</div>
                        <div class="tab ufh-tab" data-type="electro" onclick="app.setUfhCtrl('electro')">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="control-item" style="margin-top: 15px; border-top: 1px dashed #E5E7EB; padding-top: 15px;">
            <div class="label-row"><span class="lbl">–ì–æ—Ä—è—á–∞—è –≤–æ–¥–∞ (–ë–æ–π–ª–µ—Ä)</span><label class="switch"><input type="checkbox" id="chk_hw" onchange="app.toggleHW(this.checked)"><span class="slider"></span></label></div>
            <div id="blk_res" style="display:none; flex-direction:column; gap:10px; margin-top:10px; background:#F8FAFC; padding:12px; border-radius:8px; border:1px solid #E5E7EB;">
                <div style="display:flex; justify-content:space-between; align-items:center;"><span class="lbl" style="font-size:12px;">–ö–æ–ª-–≤–æ –∂–∏–ª—å—Ü–æ–≤:</span><div class="stepper" style="width:100px;"><button class="step-btn" onclick="app.updRes(-1)">‚àí</button><div class="step-val" id="val_res">3</div><button class="step-btn" onclick="app.updRes(1)">+</button></div></div>
                <div style="display:flex; justify-content:space-between; align-items:center; border-top:1px solid #E5E7EB; padding-top:8px;"><span class="lbl" style="font-size:12px;">–†–µ—Ü–∏—Ä–∫—É–ª—è—Ü–∏—è –ì–í–°</span><label class="switch" style="transform:scale(0.8); transform-origin:right;"><input type="checkbox" id="chk_recirc" onchange="app.toggleRecirc(this.checked)"><span class="slider"></span></label></div>
            </div>
        </div>

        <div class="control-item">
            <div class="label-row"><span class="lbl">–í–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ</span><label class="switch"><input type="checkbox" id="chk_water" onchange="app.toggleWater(this.checked)"><span class="slider"></span></label></div>
            <div id="blk_water_zones" style="display:none; flex-direction:column; gap:10px; margin-top:10px;">
                <div id="zones_list"></div> <button class="btn-add-zone" onclick="app.addZone()">+ –î–æ–±–∞–≤–∏—Ç—å —Å–∞–Ω—É–∑–µ–ª / –ö—É—Ö–Ω—é</button>
            </div>
        </div>
    </div>
    
    <div class="panel output-panel" id="print-area">
        <div class="print-header">
            <div class="ph-top"><div>–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é ¬´–¢–ï–†–ï–ú¬ª</div><div>www.teremopt.ru</div></div>
            <div class="ph-main"><div class="ph-logo"><img src="img/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø –¢–ï–†–ï–ú"></div><div class="ph-addr"><strong>–¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –û–§–ò–°:</strong><br>–†–æ—Å—Å–∏—è, 123100, –≥. –ú–æ—Å–∫–≤–∞<br>–≤–Ω. —Ç–µ—Ä.–≥. –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π –æ–∫—Ä—É–≥ –ü—Ä–µ—Å–Ω–µ–Ω—Å–∫–∏–π, 2-—è<br>–ó–≤–µ–Ω–∏–≥–æ—Ä–æ–¥—Å–∫–∞—è —É–ª., –¥. 12, —Å—Ç—Ä. 1, –ø–æ–º–µ—â. 16–Ω<br>—Ç–µ–ª.: +7 (495) 775-20-20, —Ñ–∞–∫—Å: +7 (495) 775-20-25</div><div class="ph-bank">–ò–ù–ù 7729646148<br>–†/—Å—á. 40702810638110013275<br>–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –±–∞–Ω–∫ –°–±–µ—Ä–±–∞–Ω–∫–∞ –†–æ—Å—Å–∏–∏ –û–ê–û –≥. –ú–æ—Å–∫–≤–∞<br>–ö/—Å—á. 30101810400000000225</div></div><hr class="ph-line">
        </div>
        <div class="doc-header">
            <div class="header-row">
                <div class="doc-title" style="display:flex; align-items:baseline;">
                    –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:&nbsp; 
                    <span id="project_name_edit" class="title-edit" contenteditable="true" onblur="app.setProjectName(this.innerText)"></span>
                </div>
                
                <div class="sku-control">
                    <span class="sku-label">–ê—Ä—Ç–∏–∫—É–ª—ã</span><label class="switch"><input type="checkbox" id="chk_sku" onchange="app.toggleSku()"><span class="slider"></span></label>
                    <span class="sku-label" style="margin-left: 15px;">–û–±—ä–µ–¥–∏–Ω—è—Ç—å</span><label class="switch"><input type="checkbox" id="chk_merge" checked onchange="app.toggleMerge()"><span class="slider"></span></label>
                </div>
            </div>
            <div class="doc-summary" id="doc_summary">...</div>
        </div>
        <table class="inv-table">
            <thead><tr><th class="col-idx">#</th><th class="col-img">–§–æ—Ç–æ</th><th class="col-name">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th><th class="col-sku hidden-col col-sku-head">–ê—Ä—Ç–∏–∫—É–ª</th><th class="col-brand">–ë—Ä–µ–Ω–¥</th><th class="col-unit">–ï–¥.</th><th class="col-qty">–ö–æ–ª.</th><th class="col-price">–¶–µ–Ω–∞</th><th class="col-sum">–°—É–º–º–∞</th></tr></thead>
            <tbody id="tbody"></tbody>
        </table>
        <div class="doc-footer"><div class="total-lbl">–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</div><div class="total-val" id="total_sum">0 ‚ÇΩ</div></div>
        <div class="footer-btns">
            <button class="btn-tg btn-base" onclick="app.sendTg()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>–ü–æ–ª—É—á–∏—Ç—å —Å—á—ë—Ç –≤ Telegram</button>
            <button class="btn-print btn-base" onclick="app.download()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>–°–∫–∞—á–∞—Ç—å PDF</button>
        </div>
    </div>
</div>
</body>
</html>